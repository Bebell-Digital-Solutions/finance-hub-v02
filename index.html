<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Dashboard - Personal & Business Finance Management</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
'#fdf2f8',
'#fce7f3',
'#fbcfe8',
'#f9a8d4',
'#f472b6',
'#ec4899',
'#DF1783',
'#be185d',
'#9d174d',
'#831843'
                        },
                        success: {
'#059669',
'#047857'
                        },
                        warning: {
'#ea580c',
'#c2410c'
                        },
                        danger: {
'#dc2626',
'#b91c1c'
                        }
                    }
                }
            },
            darkMode: 'class'
        }
    </script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- Chart.js for Financial Charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- EmailJS for Email Notifications -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    
    <style>
    
        .custom-image-widget {
  position: fixed !important;
  top: 100px !important;  /* Verify this value isn't too large */
  margin: 0 !important;
  padding: 0 !important;
    right: 0px; /* Add spacing from the edge */
        z-index: 999;
}
  
    .custom-image {
        width: 50px;
        height: auto;
       transition: transform 0.2s;
    }
    
    
      .custom-image-widget:hover .custom-image {
        transform: scale(1.05); /* Slight zoom effect */
    }  
 
 
     .custom-image-widget:hover .tooltip {
        visibility: visible;
        opacity: 1;
    }
 
    
        .sidebar-transition {
            transition: transform 0.3s ease-in-out;
        }
        
        .card-hover {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .progress-bar {
            transition: width 0.5s ease-in-out;
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        
        .dark .custom-scrollbar::-webkit-scrollbar-track {
            background: #334155;
        }
        
        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #64748b;
        }
        
        /* Chart container */
        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
        }
        
        /* Theme toggle animation */
        .theme-toggle {
            transition: all 0.3s ease;
        }
        /* Toast notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .toast.hide {
            opacity: 0;
            transform: translateY(-20px);
        }
        /* Calendar events */
        .calendar-event {
            font-size: 0.6rem;
            padding: 1px 3px;
            border-radius: 2px;
            margin: 1px 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .event-income {
            background-color: #10b981;
            color: white;
        }
        
        .event-expense {
            background-color: #DF1783;
            color: white;
        }
        
        .event-bill {
            background-color: #f59e0b;
            color: white;
        }
        .event-recurring {
            background-color: #8b5cf6;
            color: white;
        }
        /* Notion template styling */
        .notion-template {
            max-height: 70vh;
            overflow-y: auto;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif;
        }
        /* Notion table styling */
        .notion-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }
        .notion-table th,
        .notion-table td {
            border: 1px solid #e5e7eb;
            padding: 8px 12px;
            text-align: left;
        }
        .dark .notion-table th,
        .dark .notion-table td {
            border-color: #4b5563;
        }
        .notion-table th {
            background-color: #f9fafb;
            font-weight: 600;
        }
        .dark .notion-table th {
            background-color: #374151;
        }
        /* Recurring transactions styling */
        .recurring-item {
            border-left: 4px solid #DF1783;
            background-color: #fdf2f8;
        }
        .dark .recurring-item {
            background-color: #831843;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    <!-- Toast Notification -->
    <div id="toast" class="toast hide bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg">
        <span id="toast-message">Success!</span>
    </div>
    <!-- Mobile Menu Button -->
    <div class="lg:hidden fixed top-4 left-4 z-50">
        <button onclick="toggleMobileMenu()" class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 border border-gray-200 dark:border-gray-700">
            <i id="mobile-menu-icon" data-lucide="menu" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
        </button>
    </div>
    <!-- Theme Toggle Button -->
    <div class="fixed top-4 right-4 z-50">
        <button onclick="toggleTheme()" class="theme-toggle bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 border border-gray-200 dark:border-gray-700">
            <i id="theme-icon" data-lucide="sun" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
        </button>
    </div>
    <!-- Desktop Sidebar -->
    <div id="sidebar" class="hidden lg:block fixed left-0 top-0 h-full w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 shadow-lg overflow-y-auto z-10 custom-scrollbar">
        <div class="p-6">
            <!-- Logo and Header -->
            <div class="mb-8">
                <div class="w-12 h-12 bg-gradient-to-br from-primary-500 to-primary-700 rounded-lg flex items-center justify-center mb-4">
                    <i data-lucide="wallet" class="w-6 h-6 text-white"></i>
                </div>
                <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">
                    Financial Dashboard
                </h1>
                <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">
                    Your Complete Finance Management Hub
                </p>
            </div>
            <!-- Navigation Menu -->
            <nav class="space-y-2 mb-8">
                <a href="#" onclick="showSection('overview')" class="nav-item active flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="layout-dashboard" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Overview</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('accounts')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="building-2" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Accounts</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('transactions')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="credit-card" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Transactions</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <!-- NEW: Recurring Transactions Navigation -->
                <a href="#" onclick="showSection('recurring')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="repeat" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Recurring</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('budgets')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="pie-chart" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Budgets</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('reports')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="bar-chart" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Reports</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('calendar')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="calendar" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Calendar</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('settings')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="settings" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Settings</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
            </nav>
            <!-- Quick Actions -->
            <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                <div class="mb-4">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-white mb-2">üí∞ Quick Actions</h3>
                    <div class="space-y-2">
                        <button onclick="openAddTransactionModal()" class="w-full bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i data-lucide="plus" class="w-4 h-4 mr-2"></i>
                            Add Transaction
                        </button>
                        <!-- NEW: Add Recurring Button -->
                        <button onclick="openAddRecurringModal()" class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i data-lucide="repeat" class="w-4 h-4 mr-2"></i>
                            Add Recurring
                        </button>
                        <button onclick="openAddGoalModal()" class="w-full border border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 text-gray-700 dark:text-gray-300 font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i data-lucide="target" class="w-4 h-4 mr-2"></i>
                            Add Goal
                        </button>
                    </div>
                </div>
                
                <!-- Notion Template Button -->
                <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
                    <div class="mb-4">
                        <h3 class="text-sm font-semibold text-gray-900 dark:text-white mb-2">üìã Resources</h3>
                        <button onclick="openNotionTemplateModal()" class="w-full bg-pink-600 hover:bg-pink-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i data-lucide="file-text" class="w-4 h-4 mr-2"></i>
                            Notion Template
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Mobile Sidebar Overlay -->
    <div id="mobile-overlay" class="lg:hidden fixed inset-0 z-40 hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50" onclick="toggleMobileMenu()"></div>
        <div id="mobile-sidebar" class="sidebar-transition relative w-80 bg-white dark:bg-gray-800 h-full shadow-lg transform -translate-x-full">
            <!-- Copy of sidebar content for mobile -->
            <div class="p-6">
                <!-- Logo and Header -->
                <div class="mb-8">
                    <div class="w-12 h-12 bg-gradient-to-br from-primary-500 to-primary-700 rounded-lg flex items-center justify-center mb-4">
                        <i data-lucide="wallet" class="w-6 h-6 text-white"></i>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">
                        Financial Dashboard
                    </h1>
                    <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">
                        Your Complete Finance Management Hub
                    </p>
                </div>
                <!-- Navigation Menu -->
                <nav class="space-y-2 mb-8">
                    <a href="#" onclick="showSection('overview'); toggleMobileMenu()" class="mobile-nav-item active flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="layout-dashboard" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Overview</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('accounts'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="building-2" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Accounts</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('transactions'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="credit-card" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Transactions</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <!-- NEW: Mobile recurring nav -->
                    <a href="#" onclick="showSection('recurring'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="repeat" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Recurring</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('budgets'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="pie-chart" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Budgets</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('reports'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="bar-chart" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Reports</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('calendar'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="calendar" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Calendar</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('settings'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="settings" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Settings</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                </nav>
                <!-- Quick Actions -->
                <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                    <div class="mb-4">
                        <h3 class="text-sm font-semibold text-gray-900 dark:text-white mb-2">üí∞ Quick Actions</h3>
                        <div class="space-y-2">
                            <button onclick="openAddTransactionModal(); toggleMobileMenu()" class="w-full bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                                <i data-lucide="plus" class="w-4 h-4 mr-2"></i>
                                Add Transaction
                            </button>
                            <!-- NEW: Mobile recurring button -->
                            <button onclick="openAddRecurringModal(); toggleMobileMenu()" class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                                <i data-lucide="repeat" class="w-4 h-4 mr-2"></i>
                                Add Recurring
                            </button>
                            <button onclick="openAddGoalModal(); toggleMobileMenu()" class="w-full border border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 text-gray-700 dark:text-gray-300 font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                                <i data-lucide="target" class="w-4 h-4 mr-2"></i>
                                Add Goal
                            </button>
                        </div>
                    </div>
                    
                    <!-- Notion Template Button -->
                    <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
                        <div class="mb-4">
                            <h3 class="text-sm font-semibold text-gray-900 dark:text-white mb-2">üìã Resources</h3>
                            <button onclick="openNotionTemplateModal(); toggleMobileMenu()" class="w-full bg-pink-600 hover:bg-pink-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                                <i data-lucide="file-text" class="w-4 h-4 mr-2"></i>
                                Notion Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Main Content -->
    <div class="lg:ml-80 min-h-screen">
        <div class="p-4 lg:p-8 pt-20 lg:pt-8">
            
            <!-- Overview Section -->
            <div id="overview-section" class="content-section fade-in">
                <div class="max-w-7xl mx-auto">
                    <!-- Hero Section -->
                    <div class="mb-8">
                        <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-4">
                            Financial Overview
                        </h1>
                        <p class="text-lg text-gray-600 dark:text-gray-400 mb-6">
                            Track your financial health, manage budgets, and achieve your financial goals with automated recurring transactions.
                        </p>
                    </div>
                    <!-- Quick Stats with Recurring Added -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="card-hover bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Total Balance</p>
                                    <p class="text-2xl font-bold text-gray-900 dark:text-white" id="total-balance">$0.00</p>
                                </div>
                                <div class="w-12 h-12 bg-primary-100 dark:bg-primary-900 rounded-lg flex items-center justify-center">
                                    <i data-lucide="wallet" class="w-6 h-6 text-primary-600 dark:text-primary-400"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-hover bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Monthly Income</p>
                                    <p class="text-2xl font-bold text-success-600 dark:text-success-400" id="monthly-income">$0.00</p>
                                </div>
                                <div class="w-12 h-12 bg-success-100 dark:bg-success-900 rounded-lg flex items-center justify-center">
                                    <i data-lucide="trending-up" class="w-6 h-6 text-success-600 dark:text-success-400"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-hover bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Monthly Expenses</p>
                                    <p class="text-2xl font-bold text-danger-600 dark:text-danger-400" id="monthly-expenses">$0.00</p>
                                </div>
                                <div class="w-12 h-12 bg-danger-100 dark:bg-danger-900 rounded-lg flex items-center justify-center">
                                    <i data-lucide="trending-down" class="w-6 h-6 text-danger-600 dark:text-danger-400"></i>
                                </div>
                            </div>
                        </div>
                        
                        <!-- NEW: Active Recurring Stats -->
                        <div class="card-hover bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Active Recurring</p>
                                    <p class="text-2xl font-bold text-purple-600 dark:text-purple-400" id="active-recurring">0</p>
                                </div>
                                <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center">
                                    <i data-lucide="repeat" class="w-6 h-6 text-purple-600 dark:text-purple-400"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Charts and other overview content -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Spending Trends</h3>
                            <div class="chart-container">
                                <canvas id="spending-chart"></canvas>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Budget Overview</h3>
                            <div class="chart-container">
                                <canvas id="budget-chart"></canvas>
                            </div>
                        </div>
                    </div>
                    <!-- Recent Transactions with Recurring Indicators -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Recent Transactions</h3>
                            <button onclick="showSection('transactions')" class="text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-medium">View All</button>
                        </div>
                        <div id="recent-transactions" class="space-y-4">
                            <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                                <i data-lucide="credit-card" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                                <p>No transactions yet. Add your first transaction to get started!</p>
                            </div>
                        </div>
                    </div>
                    <!-- Financial Goals -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Financial Goals</h3>
                            <button onclick="openAddGoalModal()" class="text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-medium">Add Goal</button>
                        </div>
                        <div id="financial-goals" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                                <i data-lucide="target" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                                <p>No goals set yet. Add your first financial goal!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- NEW: RECURRING TRANSACTIONS SECTION -->
            <div id="recurring-section" class="content-section hidden fade-in">
                <div class="max-w-7xl mx-auto">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-2">Recurring Transactions</h1>
                            <p class="text-lg text-gray-600 dark:text-gray-400">Automate your regular income and expenses with smart recurring transactions</p>
                        </div>
                        <button onclick="openAddRecurringModal()" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center">
                            <i data-lucide="plus" class="w-4 h-4 mr-2"></i>
                            Add Recurring
                        </button>
                    </div>
                    <!-- Recurring Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Active Recurring</p>
                                    <p class="text-2xl font-bold text-primary-600 dark:text-primary-400" id="total-recurring">0</p>
                                </div>
                                <div class="w-12 h-12 bg-primary-100 dark:bg-primary-900 rounded-lg flex items-center justify-center">
                                    <i data-lucide="repeat" class="w-6 h-6 text-primary-600 dark:text-primary-400"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Monthly Impact</p>
                                    <p class="text-2xl font-bold text-gray-900 dark:text-white" id="monthly-recurring">$0.00</p>
                                </div>
                                <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center">
                                    <i data-lucide="calendar" class="w-6 h-6 text-blue-600 dark:text-blue-400"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Next Due</p>
                                    <p class="text-lg font-bold text-orange-600 dark:text-orange-400" id="next-due">None</p>
                                </div>
                                <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center">
                                    <i data-lucide="clock" class="w-6 h-6 text-orange-600 dark:text-orange-400"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Recurring Transactions Table -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Active Recurring Transactions</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50 dark:bg-gray-900">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Description</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Type</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Amount</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Frequency</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Next Date</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="recurring-table-body" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <tr>
                                        <td colspan="7" class="px-6 py-12 text-center">
                                            <div class="text-gray-500 dark:text-gray-400">
                                                <i data-lucide="repeat" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                                                <p class="text-lg mb-2">No recurring transactions yet</p>
                                                <p>Set up your first recurring transaction to automate your finances!</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Continue with ALL your existing sections exactly as they are -->
            <!-- For brevity in this response, I'm indicating they remain the same -->
            <!-- Accounts Section - keeping exactly as you have it -->
            <div id="accounts-section" class="content-section hidden fade-in">
                <!-- Your existing accounts section content -->
            </div>
            <!-- Transactions Section - keeping exactly as you have it -->
            <div id="transactions-section" class="content-section hidden fade-in">
                <!-- Your existing transactions section content -->
            </div>
            <!-- Budgets Section - keeping exactly as you have it -->
            <div id="budgets-section" class="content-section hidden fade-in">
                <!-- Your existing budgets section content -->
            </div>
            <!-- Reports Section - keeping exactly as you have it -->
            <div id="reports-section" class="content-section hidden fade-in">
                <!-- Your existing reports section content -->
            </div>
            <!-- Calendar Section - keeping exactly as you have it -->
            <div id="calendar-section" class="content-section hidden fade-in">
                <!-- Your existing calendar section content -->
            </div>
            <!-- Settings Section - keeping exactly as you have it -->
            <div id="settings-section" class="content-section hidden fade-in">
                <!-- Your existing settings section content -->
            </div>
        </div>
    </div>
    <!-- Modal Backdrop -->
    <div id="modal-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden" onclick="closeAllModals()"></div>
    <!-- Your existing modals exactly as they are -->
    <!-- Add Transaction Modal -->
    <div id="add-transaction-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <!-- Your existing transaction modal content -->
    </div>
    <!-- NEW: Add Recurring Modal -->
    <div id="add-recurring-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Add Recurring Transaction</h3>
                    <button onclick="closeModal('add-recurring-modal')" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                <form id="recurring-form" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Type</label>
                        <select id="recurring-type" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" required>
                            <option value="expense">Expense</option>
                            <option value="income">Income</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Amount</label>
                        <input type="number" id="recurring-amount" step="0.01" min="0" placeholder="0.00" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Description</label>
                        <input type="text" id="recurring-description" placeholder="e.g., Monthly Salary, Netflix Subscription" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Category</label>
                        <select id="recurring-category" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" required>
                            <option value="">Select Category</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Account</label>
                        <select id="recurring-account" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" required>
                            <option value="">Select Account</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Frequency</label>
                        <select id="recurring-frequency" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" required>
                            <option value="weekly">Weekly</option>
                            <option value="biweekly">Bi-weekly</option>
                            <option value="monthly">Monthly</option>
                            <option value="quarterly">Quarterly</option>
                            <option value="annually">Annually</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Start Date</label>
                        <input type="date" id="recurring-start-date" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">End Date (Optional)</label>
                        <input type="date" id="recurring-end-date"
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="recurring-auto-create" class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500">
                        <label class="ml-2 text-sm text-gray-700 dark:text-gray-300">Automatically create transactions</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="recurring-email-reminder" class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500">
                        <label class="ml-2 text-sm text-gray-700 dark:text-gray-300">Send email reminders</label>
                    </div>
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" onclick="closeModal('add-recurring-modal')" 
                                class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                            Cancel
                        </button>
                        <button type="submit" 
                                class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg">
                            Add Recurring
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- ENHANCED NOTION TEMPLATE MODAL WITH COMPREHENSIVE FINANCIAL STRUCTURE -->
    <div id="notion-template-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col">
                <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-2xl font-semibold text-gray-900 dark:text-white">üìã Complete Financial Dashboard Template</h3>
                    <button onclick="closeModal('notion-template-modal')" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
                
                <div class="flex-1 overflow-y-auto p-6 notion-template">
                    <!-- Header Section -->
                    <div class="text-center mb-8">
                        <div class="w-20 h-20 bg-gradient-to-br from-pink-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6">
                            <i data-lucide="calculator" class="w-10 h-10 text-white"></i>
                        </div>
                        <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-3">üí∞ Personal Finance Dashboard</h1>
                        <p class="text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">Your comprehensive Notion template for managing personal finances, tracking recurring transactions, and achieving financial goals</p>
                    </div>
                    <!-- Quick Setup Guide -->
                    <div class="bg-blue-50 dark:bg-blue-900/30 rounded-xl p-6 mb-8">
                        <h2 class="text-xl font-semibold text-blue-900 dark:text-blue-200 mb-4">üöÄ Quick Setup Guide</h2>
                        <div class="grid md:grid-cols-2 gap-4">
                            <ol class="space-y-2 text-blue-800 dark:text-blue-300">
                                <li class="flex items-start"><span class="font-bold mr-2">1.</span> Click "Copy Template" button below</li>
                                <li class="flex items-start"><span class="font-bold mr-2">2.</span> Open in your Notion workspace</li>
                                <li class="flex items-start"><span class="font-bold mr-2">3.</span> Delete sample data from databases</li>
                            </ol>
                            <ol class="space-y-2 text-blue-800 dark:text-blue-300" start="4">
                                <li class="flex items-start"><span class="font-bold mr-2">4.</span> Add your accounts & set initial balances</li>
                                <li class="flex items-start"><span class="font-bold mr-2">5.</span> Configure categories & monthly budgets</li>
                                <li class="flex items-start"><span class="font-bold mr-2">6.</span> Set up recurring transactions for automation</li>
                            </ol>
                        </div>
                    </div>
                    <!-- Database Structures -->
                    <div class="mb-8">
                        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">üóÉÔ∏è Database Structure</h2>
                        
                        <!-- Accounts Database -->
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">1. üè¶ Accounts Database</h3>
                            <div class="overflow-x-auto">
                                <table class="notion-table">
                                    <thead>
                                        <tr>
                                            <th>Account Name</th>
                                            <th>Type</th>
                                            <th>Bank/Institution</th>
                                            <th>Current Balance</th>
                                            <th>Credit Limit</th>
                                            <th>Status</th>
                                            <th>Last Updated</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Main Checking</td>
                                            <td>Checking</td>
                                            <td>Chase Bank</td>
                                            <td>$2,450.00</td>
                                            <td>N/A</td>
                                            <td>‚úÖ Active</td>
                                            <td>2024-12-15</td>
                                        </tr>
                                        <tr>
                                            <td>Travel Credit Card</td>
                                            <td>Credit Card</td>
                                            <td>Chase Sapphire</td>
                                            <td>-$350.00</td>
                                            <td>$5,000.00</td>
                                            <td>‚úÖ Active</td>
                                            <td>2024-12-15</td>
                                        </tr>
                                        <tr>
                                            <td>Emergency Savings</td>
                                            <td>Savings</td>
                                            <td>Ally Bank</td>
                                            <td>$8,750.00</td>
                                            <td>N/A</td>
                                            <td>‚úÖ Active</td>
                                            <td>2024-12-15</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- Transactions Database -->
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">2. üí≥ Transactions Database</h3>
                            <div class="overflow-x-auto">
                                <table class="notion-table">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Description</th>
                                            <th>Category</th>
                                            <th>Type</th>
                                            <th>Amount</th>
                                            <th>Account</th>
                                            <th>Recurring</th>
                                            <th>Tags</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>2024-12-15</td>
                                            <td>Monthly Salary</td>
                                            <td>üíº Income</td>
                                            <td>üìà Income</td>
                                            <td>+$4,500.00</td>
                                            <td>Main Checking</td>
                                            <td>‚úÖ Yes</td>
                                            <td>Work, Monthly</td>
                                        </tr>
                                        <tr>
                                            <td>2024-12-14</td>
                                            <td>Grocery Shopping</td>
                                            <td>üçï Food</td>
                                            <td>üìâ Expense</td>
                                            <td>-$87.50</td>
                                            <td>Main Checking</td>
                                            <td>‚ùå No</td>
                                            <td>Essential</td>
                                        </tr>
                                        <tr>
                                            <td>2024-12-13</td>
                                            <td>Netflix Subscription</td>
                                            <td>üé¨ Entertainment</td>
                                            <td>üìâ Expense</td>
                                            <td>-$15.99</td>
                                            <td>Travel Credit Card</td>
                                            <td>‚úÖ Yes</td>
                                            <td>Subscription</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- Categories Database -->
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">3. üìä Categories & Budgets Database</h3>
                            <div class="overflow-x-auto">
                                <table class="notion-table">
                                    <thead>
                                        <tr>
                                            <th>Category</th>
                                            <th>Icon</th>
                                            <th>Monthly Budget</th>
                                            <th>Current Spent</th>
                                            <th>Remaining</th>
                                            <th>Progress</th>
                                            <th>Type</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Food & Dining</td>
                                            <td>üçï</td>
                                            <td>$500.00</td>
                                            <td>$287.50</td>
                                            <td>$212.50</td>
                                            <td>57.5%</td>
                                            <td>Expense</td>
                                        </tr>
                                        <tr>
                                            <td>Transportation</td>
                                            <td>üöó</td>
                                            <td>$300.00</td>
                                            <td>$145.00</td>
                                            <td>$155.00</td>
                                            <td>48.3%</td>
                                            <td>Expense</td>
                                        </tr>
                                        <tr>
                                            <td>Entertainment</td>
                                            <td>üé¨</td>
                                            <td>$200.00</td>
                                            <td>$75.99</td>
                                            <td>$124.01</td>
                                            <td>38.0%</td>
                                            <td>Expense</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- Recurring Transactions Database -->
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">4. üîÑ Recurring Transactions Database</h3>
                            <div class="overflow-x-auto">
                                <table class="notion-table">
                                    <thead>
                                        <tr>
                                            <th>Description</th>
                                            <th>Type</th>
                                            <th>Amount</th>
                                            <th>Frequency</th>
                                            <th>Next Date</th>
                                            <th>Account</th>
                                            <th>Category</th>
                                            <th>Auto-Create</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Monthly Salary</td>
                                            <td>üìà Income</td>
                                            <td>+$4,500.00</td>
                                            <td>Monthly</td>
                                            <td>2025-01-15</td>
                                            <td>Main Checking</td>
                                            <td>üíº Income</td>
                                            <td>‚úÖ Yes</td>
                                            <td>‚úÖ Active</td>
                                        </tr>
                                        <tr>
                                            <td>Rent Payment</td>
                                            <td>üìâ Expense</td>
                                            <td>-$1,200.00</td>
                                            <td>Monthly</td>
                                            <td>2025-01-01</td>
                                            <td>Main Checking</td>
                                            <td>üè† Housing</td>
                                            <td>‚úÖ Yes</td>
                                            <td>‚úÖ Active</td>
                                        </tr>
                                        <tr>
                                            <td>Netflix Subscription</td>
                                            <td>üìâ Expense</td>
                                            <td>-$15.99</td>
                                            <td>Monthly</td>
                                            <td>2025-01-13</td>
                                            <td>Travel Credit Card</td>
                                            <td>üé¨ Entertainment</td>
                                            <td>‚úÖ Yes</td>
                                            <td>‚úÖ Active</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- Financial Goals Database -->
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">5. üéØ Financial Goals Database</h3>
                            <div class="overflow-x-auto">
                                <table class="notion-table">
                                    <thead>
                                        <tr>
                                            <th>Goal Name</th>
                                            <th>Target Amount</th>
                                            <th>Current Amount</th>
                                            <th>Progress</th>
                                            <th>Target Date</th>
                                            <th>Monthly Required</th>
                                            <th>Priority</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Emergency Fund</td>
                                            <td>$10,000.00</td>
                                            <td>$8,750.00</td>
                                            <td>87.5%</td>
                                            <td>2025-03-01</td>
                                            <td>$417.00</td>
                                            <td>üî• High</td>
                                            <td>üìà In Progress</td>
                                        </tr>
                                        <tr>
                                            <td>Vacation Fund</td>
                                            <td>$3,000.00</td>
                                            <td>$1,200.00</td>
                                            <td>40.0%</td>
                                            <td>2025-06-01</td>
                                            <td>$300.00</td>
                                            <td>‚ö° Medium</td>
                                            <td>üìà In Progress</td>
                                        </tr>
                                        <tr>
                                            <td>Car Down Payment</td>
                                            <td>$8,000.00</td>
                                            <td>$2,500.00</td>
                                            <td>31.3%</td>
                                            <td>2025-12-01</td>
                                            <td>$458.00</td>
                                            <td>üí° Low</td>
                                            <td>üìà In Progress</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- Dashboard Views -->
                    <div class="mb-8">
                        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">üì± Dashboard Views</h2>
                        
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                <h3 class="font-semibold text-gray-900 dark:text-white mb-3">üìä Monthly Overview</h3>
                                <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-300">
                                    <li>‚Ä¢ Total income vs expenses</li>
                                    <li>‚Ä¢ Budget progress by category</li>
                                    <li>‚Ä¢ Account balances summary</li>
                                    <li>‚Ä¢ Top spending categories</li>
                                    <li>‚Ä¢ Upcoming recurring transactions</li>
                                </ul>
                            </div>
                            
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                <h3 class="font-semibold text-gray-900 dark:text-white mb-3">üéØ Goals Tracker</h3>
                                <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-300">
                                    <li>‚Ä¢ Visual progress bars</li>
                                    <li>‚Ä¢ Time remaining calculations</li>
                                    <li>‚Ä¢ Monthly savings required</li>
                                    <li>‚Ä¢ Goal achievement timeline</li>
                                    <li>‚Ä¢ Priority-based sorting</li>
                                </ul>
                            </div>
                            
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                <h3 class="font-semibold text-gray-900 dark:text-white mb-3">üîÑ Recurring Manager</h3>
                                <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-300">
                                    <li>‚Ä¢ Auto-transaction creation</li>
                                    <li>‚Ä¢ Next payment reminders</li>
                                    <li>‚Ä¢ Subscription tracking</li>
                                    <li>‚Ä¢ Income schedule overview</li>
                                    <li>‚Ä¢ Annual cost projections</li>
                                </ul>
                            </div>
                            
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                <h3 class="font-semibold text-gray-900 dark:text-white mb-3">üìà Reports & Analytics</h3>
                                <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-300">
                                    <li>‚Ä¢ Monthly/yearly comparisons</li>
                                    <li>‚Ä¢ Category spending trends</li>
                                    <li>‚Ä¢ Cash flow analysis</li>
                                    <li>‚Ä¢ Budget vs actual reports</li>
                                    <li>‚Ä¢ Net worth tracking</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- Advanced Features -->
                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/30 dark:to-pink-900/30 rounded-xl p-6 mb-8">
                        <h2 class="text-xl font-semibold text-purple-900 dark:text-purple-200 mb-4">‚ú® Advanced Features</h2>
                        <div class="grid md:grid-cols-3 gap-4">
                            <div>
                                <h4 class="font-semibold text-purple-800 dark:text-purple-300 mb-2">ü§ñ Automation</h4>
                                <ul class="space-y-1 text-sm text-purple-700 dark:text-purple-300">
                                    <li>‚Ä¢ Auto-categorization</li>
                                    <li>‚Ä¢ Recurring reminders</li>
                                    <li>‚Ä¢ Budget alerts</li>
                                    <li>‚Ä¢ Goal milestones</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold text-purple-800 dark:text-purple-300 mb-2">üìä Analytics</h4>
                                <ul class="space-y-1 text-sm text-purple-700 dark:text-purple-300">
                                    <li>‚Ä¢ Spending patterns</li>
                                    <li>‚Ä¢ Monthly trends</li>
                                    <li>‚Ä¢ Category insights</li>
                                    <li>‚Ä¢ Savings rate tracking</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold text-purple-800 dark:text-purple-300 mb-2">üîß Customization</h4>
                                <ul class="space-y-1 text-sm text-purple-700 dark:text-purple-300">
                                    <li>‚Ä¢ Custom categories</li>
                                    <li>‚Ä¢ Personal tags</li>
                                    <li>‚Ä¢ Currency support</li>
                                    <li>‚Ä¢ Theme options</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- Pro Tips -->
                    <div class="bg-yellow-50 dark:bg-yellow-900/30 rounded-xl p-6">
                        <h2 class="text-xl font-semibold text-yellow-900 dark:text-yellow-200 mb-4">üí° Pro Tips for Success</h2>
                        <div class="grid md:grid-cols-2 gap-4">
                            <ul class="space-y-3 text-yellow-800 dark:text-yellow-300">
                                <li class="flex items-start">
                                    <span class="text-yellow-600 mr-2">‚Ä¢</span>
                                    <span>Update your account balances weekly for accuracy</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-yellow-600 mr-2">‚Ä¢</span>
                                    <span>Set realistic monthly budgets based on 3-month averages</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-yellow-600 mr-2">‚Ä¢</span>
                                    <span>Use tags for detailed transaction categorization</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-yellow-600 mr-2">‚Ä¢</span>
                                    <span>Review and adjust goals quarterly</span>
                                </li>
                            </ul>
                            <ul class="space-y-3 text-yellow-800 dark:text-yellow-300">
                                <li class="flex items-start">
                                    <span class="text-yellow-600 mr-2">‚Ä¢</span>
                                    <span>Set up all recurring transactions for automation</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-yellow-600 mr-2">‚Ä¢</span>
                                    <span>Track both needs and wants in separate categories</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-yellow-600 mr-2">‚Ä¢</span>
                                    <span>Use the monthly overview for financial check-ins</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-yellow-600 mr-2">‚Ä¢</span>
                                    <span>Export data monthly for backup purposes</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Action Buttons -->
                <div class="flex justify-between items-center p-6 border-t border-gray-200 dark:border-gray-700">
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        <p>Created by Bebell Digital Solutions</p>
                        <p>Complete template with databases, formulas, and automation</p>
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="downloadNotionTemplate()" class="px-6 py-3 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center font-medium">
                            <i data-lucide="download" class="w-4 h-4 mr-2"></i>
                            Download Template
                        </button>
                        <button onclick="copyNotionTemplate()" class="px-6 py-3 bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-700 hover:to-purple-700 text-white rounded-lg flex items-center font-medium">
                            <i data-lucide="copy" class="w-4 h-4 mr-2"></i>
                            Copy to Notion
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Your existing modals for accounts, budgets, goals, etc. - keeping exactly as they are -->
    <!-- JavaScript with Enhanced Functionality -->
    <script>
        // Enhanced Financial Data Management with Recurring Transactions
        class FinancialData {
            constructor() {
                this.accounts = this.loadFromStorage('accounts', []);
                this.transactions = this.loadFromStorage('transactions', []);
                this.categories = this.loadFromStorage('categories', this.getDefaultCategories());
                this.goals = this.loadFromStorage('goals', []);
                this.settings = this.loadFromStorage('settings', this.getDefaultSettings());
                this.bills = this.loadFromStorage('bills', []);
                this.recurring = this.loadFromStorage('recurring', []); // NEW: Recurring transactions
            }
            // NEW: Recurring transaction management
            addRecurring(recurring) {
                recurring.id = Date.now();
                recurring.isActive = true;
                recurring.nextDate = this.calculateNextDate(recurring.startDate, recurring.frequency);
                this.recurring.push(recurring);
                this.saveToStorage('recurring', this.recurring);
                return recurring;
            }
            updateRecurring(id, updates) {
                const index = this.recurring.findIndex(r => r.id === id);
                if (index !== -1) {
                    this.recurring[index] = { ...this.recurring[index], ...updates };
                    this.saveToStorage('recurring', this.recurring);
                    return this.recurring[index];
                }
                return null;
            }
            deleteRecurring(id) {
                this.recurring = this.recurring.filter(r => r.id !== id);
                this.saveToStorage('recurring', this.recurring);
            }
            // Calculate next occurrence date based on frequency
            calculateNextDate(startDate, frequency) {
                const date = new Date(startDate);
                const today = new Date();
                
                if (date > today) {
                    return date.toISOString().split('T')[0];
                }
                
                switch (frequency) {
                    case 'weekly':
                        date.setDate(date.getDate() + 7);
                        while (date <= today) {
                            date.setDate(date.getDate() + 7);
                        }
                        break;
                    case 'biweekly':
                        date.setDate(date.getDate() + 14);
                        while (date <= today) {
                            date.setDate(date.getDate() + 14);
                        }
                        break;
                    case 'monthly':
                        date.setMonth(date.getMonth() + 1);
                        while (date <= today) {
                            date.setMonth(date.getMonth() + 1);
                        }
                        break;
                    case 'quarterly':
                        date.setMonth(date.getMonth() + 3);
                        while (date <= today) {
                            date.setMonth(date.getMonth() + 3);
                        }
                        break;
                    case 'annually':
                        date.setFullYear(date.getFullYear() + 1);
                        while (date <= today) {
                            date.setFullYear(date.getFullYear() + 1);
                        }
                        break;
                }
                
                return date.toISOString().split('T')[0];
            }
            // Process recurring transactions (check for due dates and auto-create)
            processRecurringTransactions() {
                const today = new Date().toISOString().split('T')[0];
                
                this.recurring.forEach(recurring => {
                    if (recurring.isActive && recurring.nextDate === today && recurring.autoCreate) {
                        const transaction = {
                            type: recurring.type,
                            amount: recurring.type === 'expense' ? -Math.abs(recurring.amount) : Math.abs(recurring.amount),
                            description: recurring.description,
                            category: recurring.category,
                            account: recurring.account,
                            date: today,
                            isRecurring: true,
                            recurringId: recurring.id
                        };
                        
                        this.addTransaction(transaction);
                        
                        recurring.nextDate = this.calculateNextDate(today, recurring.frequency);
                        this.saveToStorage('recurring', this.recurring);
                        
                        if (recurring.emailReminder && this.settings.emailNotifications) {
                            this.sendRecurringNotification(recurring, transaction);
                        }
                    }
                });
            }
            getRecurringForDate(date) {
                const dateStr = date.toISOString().split('T')[0];
                return this.recurring.filter(r => r.nextDate === dateStr && r.isActive);
            }
            sendRecurringNotification(recurring, transaction) {
                if (this.settings.emailNotifications && this.settings.notificationEmail && window.emailJS) {
                    const templateParams = {
                        to_email: this.settings.notificationEmail,
                        subject: `Recurring Transaction Created: ${recurring.description}`,
                        message: `Your recurring ${transaction.type} "${recurring.description}" for ${formatCurrency(Math.abs(transaction.amount))} has been automatically created.`
                    };
                    window.emailJS.send('BebellDigitalSolutions', 'bebell_notifications', templateParams)
                        .catch(error => console.error('Failed to send recurring notification:', error));
                }
            }
            // Keep all your existing methods exactly as they are
            loadFromStorage(key, defaultValue) {
                try {
                    const data = localStorage.getItem(`financialData_${key}`);
                    return data ? JSON.parse(data) : defaultValue;
                } catch (error) {
                    console.error(`Error loading ${key} from storage:`, error);
                    return defaultValue;
                }
            }
            saveToStorage(key, data) {
                try {
                    localStorage.setItem(`financialData_${key}`, JSON.stringify(data));
                } catch (error) {
                    console.error(`Error saving ${key} to storage:`, error);
                }
            }
            getDefaultCategories() {
                return [
                    { id: 1, name: "Housing", budget: 1500, color: "#3b82f6" },
                    { id: 2, name: "Food", budget: 600, color: "#10b981" },
                    { id: 3, name: "Transportation", budget: 300, color: "#f59e0b" },
                    { id: 4, name: "Utilities", budget: 200, color: "#8b5cf6" },
                    { id: 5, name: "Entertainment", budget: 150, color: "#ef4444" },
                    { id: 6, name: "Healthcare", budget: 300, color: "#06b6d4" },
                    { id: 7, name: "Shopping", budget: 250, color: "#84cc16" },
                    { id: 8, name: "Salary", budget: 0, color: "#059669" },
                    { id: 9, name: "Freelance", budget: 0, color: "#0ea5e9" },
                    { id: 10, name: "Other", budget: 100, color: "#6b7280" }
                ];
            }
            getDefaultSettings() {
                return {
                    theme: 'system',
                    currency: 'USD',
                    dateFormat: 'MM/DD/YYYY',
                    budgetAlerts: true,
                    billReminders: true,
                    recurringReminders: true, // NEW
                    goalProgress: true,
                    emailNotifications: false,
                    notificationEmail: '',
                    notificationFrequency: 'daily',
                    twoFactor: false
                };
            }
            // Keep all your existing methods for accounts, transactions, goals, etc.
            addAccount(account) {
                account.id = Date.now();
                this.accounts.push(account);
                this.saveToStorage('accounts', this.accounts);
                return account;
            }
            addTransaction(transaction) {
                transaction.id = Date.now();
                this.transactions.push(transaction);
                
                // Update account balance
                const account = this.accounts.find(a => a.id === transaction.account);
                if (account) {
                    if (transaction.type === 'expense') {
                        account.balance -= Math.abs(transaction.amount);
                    } else if (transaction.type === 'income') {
                        account.balance += Math.abs(transaction.amount);
                    }
                    this.saveToStorage('accounts', this.accounts);
                }
                
                this.saveToStorage('transactions', this.transactions);
                return transaction;
            }
            addGoal(goal) {
                goal.id = Date.now();
                this.goals.push(goal);
                this.saveToStorage('goals', this.goals);
                return goal;
            }
            updateSettings(updates) {
                this.settings = { ...this.settings, ...updates };
                this.saveToStorage('settings', this.settings);
            }
            getTransactionsForDate(date) {
                const dateStr = date.toISOString().split('T')[0];
                return this.transactions.filter(t => t.date === dateStr);
            }
            getBillsForDate(date) {
                const dateStr = date.toISOString().split('T')[0];
                return this.bills.filter(b => b.dueDate === dateStr);
            }
        }
        // Global variables
        let financialData = new FinancialData();
        let currentSection = 'overview';
        let isDarkMode = localStorage.getItem('theme') === 'dark' || 
                        (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches);
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let charts = {};
        let emailJS = null;
        // NEW: Recurring transactions functions
        function openAddRecurringModal() {
            showModal('add-recurring-modal');
        }
        function loadRecurringSection() {
            loadRecurringStats();
            loadRecurringTransactions();
        }
        function loadRecurringStats() {
            const activeRecurring = financialData.recurring.filter(r => r.isActive).length;
            const monthlyTotal = financialData.recurring
                .filter(r => r.isActive)
                .reduce((sum, r) => {
                    let monthlyAmount = 0;
                    switch(r.frequency) {
                        case 'weekly': monthlyAmount = r.amount * 4.33; break;
                        case 'biweekly': monthlyAmount = r.amount * 2.17; break;
                        case 'monthly': monthlyAmount = r.amount; break;
                        case 'quarterly': monthlyAmount = r.amount / 3; break;
                        case 'annually': monthlyAmount = r.amount / 12; break;
                    }
                    return sum + (r.type === 'income' ? monthlyAmount : -monthlyAmount);
                }, 0);
            const nextDue = financialData.recurring
                .filter(r => r.isActive)
                .sort((a, b) => new Date(a.nextDate) - new Date(b.nextDate))[0];
            document.getElementById('total-recurring').textContent = activeRecurring;
            document.getElementById('active-recurring').textContent = activeRecurring;
            document.getElementById('monthly-recurring').textContent = formatCurrency(Math.abs(monthlyTotal));
            document.getElementById('next-due').textContent = nextDue ? formatDate(nextDue.nextDate) : 'None';
        }
        function loadRecurringTransactions() {
            const tbody = document.getElementById('recurring-table-body');
            if (!tbody) return;
            
            if (financialData.recurring.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-6 py-12 text-center">
                            <div class="text-gray-500 dark:text-gray-400">
                                <i data-lucide="repeat" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                                <p class="text-lg mb-2">No recurring transactions yet</p>
                                <p>Set up your first recurring transaction to automate your finances!</p>
                            </div>
                        </td>
                    </tr>
                `;
            } else {
                tbody.innerHTML = financialData.recurring.map(recurring => {
                    const account = financialData.accounts.find(a => a.id === recurring.account);
                    const isExpense = recurring.type === 'expense';
                    const amountClass = isExpense ? 'text-danger-600 dark:text-danger-400' : 'text-success-600 dark:text-success-400';
                    const statusBadge = recurring.isActive 
                        ? '<span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200">Active</span>'
                        : '<span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200">Inactive</span>';
                    
                    return `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 ${recurring.isActive ? '' : 'opacity-60'}">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-gray-100 dark:bg-gray-600 rounded-lg flex items-center justify-center mr-3">
                                        <i data-lucide="repeat" class="w-4 h-4 text-gray-600 dark:text-gray-400"></i>
                                    </div>
                                    <span class="text-sm font-medium text-gray-900 dark:text-white">${recurring.description}</span>
                                </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${isExpense ? 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200' : 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200'}">
                                    ${recurring.type.charAt(0).toUpperCase() + recurring.type.slice(1)}
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold ${amountClass}">${formatCurrency(Math.abs(recurring.amount))}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${recurring.frequency.charAt(0).toUpperCase() + recurring.frequency.slice(1)}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${formatDate(recurring.nextDate)}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${statusBadge}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 space-x-2">
                                <button onclick="editRecurring(${recurring.id})" class="text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-300">Edit</button>
                                <button onclick="toggleRecurring(${recurring.id})" class="text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300">${recurring.isActive ? 'Pause' : 'Activate'}</button>
                                <button onclick="deleteRecurring(${recurring.id})" class="text-danger-600 dark:text-danger-400 hover:text-danger-900 dark:hover:text-danger-300">Delete</button>
                            </td>
                        </tr>
                    `;
                }).join('');
            }
            lucide.createIcons();
        }
        function editRecurring(id) {
            const recurring = financialData.recurring.find(r => r.id === id);
            if (recurring) {
                document.getElementById('recurring-type').value = recurring.type;
                document.getElementById('recurring-amount').value = Math.abs(recurring.amount);
                document.getElementById('recurring-description').value = recurring.description;
                document.getElementById('recurring-category').value = recurring.category;
                document.getElementById('recurring-account').value = recurring.account;
                document.getElementById('recurring-frequency').value = recurring.frequency;
                document.getElementById('recurring-start-date').value = recurring.startDate;
                document.getElementById('recurring-end-date').value = recurring.endDate || '';
                document.getElementById('recurring-auto-create').checked = recurring.autoCreate;
                document.getElementById('recurring-email-reminder').checked = recurring.emailReminder;
                
                document.getElementById('recurring-form').dataset.editId = id;
                showModal('add-recurring-modal');
            }
        }
        function toggleRecurring(id) {
            const recurring = financialData.recurring.find(r => r.id === id);
            if (recurring) {
                recurring.isActive = !recurring.isActive;
                financialData.saveToStorage('recurring', financialData.recurring);
                loadRecurringSection();
                showToast(`Recurring transaction ${recurring.isActive ? 'activated' : 'paused'}`, 'success');
            }
        }
        function deleteRecurring(id) {
            if (confirm('Are you sure you want to delete this recurring transaction?')) {
                financialData.deleteRecurring(id);
                loadRecurringSection();
                showToast('Recurring transaction deleted successfully', 'success');
            }
        }
        // ENHANCED NOTION TEMPLATE FUNCTIONS
        function openNotionTemplateModal() {
            showModal('notion-template-modal');
        }
        function copyNotionTemplate() {
            const templateText = `# üìã PERSONAL FINANCE DASHBOARD TEMPLATE
üöÄ **SETUP INSTRUCTIONS:**
1. Create a new Notion page
2. Copy these database templates below
3. Set up the database properties as shown
4. Import your financial data
5. Customize categories and budgets
6. Set up recurring transactions for automation
---
üè¶ **ACCOUNTS DATABASE**
Properties:
- Account Name (Title)
- Type (Select: Checking, Savings, Credit Card, Investment, Business)
- Bank/Institution (Text)
- Current Balance (Number, Currency)
- Credit Limit (Number, Currency)
- Status (Select: Active, Inactive, Closed)
- Last Updated (Date)
---
üí≥ **TRANSACTIONS DATABASE**
Properties:
- Date (Date)
- Description (Title)
- Category (Relation to Categories)
- Type (Select: Income, Expense, Transfer)
- Amount (Number, Currency)
- Account (Relation to Accounts)
- Recurring (Checkbox)
- Tags (Multi-select)
- Notes (Text)
---
üìä **CATEGORIES & BUDGETS DATABASE**
Properties:
- Category (Title)
- Icon (Text)
- Monthly Budget (Number, Currency)
- Current Spent (Rollup from Transactions)
- Remaining (Formula: Budget - Current Spent)
- Progress (Formula: Current Spent / Budget * 100)
- Type (Select: Income, Expense)
- Color (Text)
---
üîÑ **RECURRING TRANSACTIONS DATABASE**
Properties:
- Description (Title)
- Type (Select: Income, Expense)
- Amount (Number, Currency)
- Frequency (Select: Weekly, Bi-weekly, Monthly, Quarterly, Annually)
- Next Date (Date)
- Account (Relation to Accounts)
- Category (Relation to Categories)
- Auto-Create (Checkbox)
- Email Reminder (Checkbox)
- Status (Select: Active, Paused, Cancelled)
- End Date (Date)
---
üéØ **FINANCIAL GOALS DATABASE**
Properties:
- Goal Name (Title)
- Target Amount (Number, Currency)
- Current Amount (Number, Currency)
- Progress (Formula: Current / Target * 100)
- Target Date (Date)
- Monthly Required (Formula)
- Priority (Select: High, Medium, Low)
- Status (Select: In Progress, Completed, On Hold)
- Notes (Text)
---
üì± **DASHBOARD VIEWS TO CREATE:**
1. **Monthly Overview** - Filter transactions by current month
2. **Budget Tracker** - Show category spending vs budgets
3. **Recurring Manager** - Active recurring transactions
4. **Goals Progress** - Visual goal tracking
5. **Account Summary** - Current balances and totals
---
üí° **FORMULAS TO USE:**
**Remaining Budget:**
\`if(prop("Monthly Budget") > 0, prop("Monthly Budget") - prop("Current Spent"), 0)\`
**Progress Percentage:**
\`if(prop("Monthly Budget") > 0, round(prop("Current Spent") / prop("Monthly Budget") * 100), 0)\`
**Days to Goal:**
\`dateBetween(prop("Target Date"), now(), "days")\`
**Monthly Required for Goal:**
\`if(prop("Target Date") > now(), (prop("Target Amount") - prop("Current Amount")) / dateBetween(prop("Target Date"), now(), "months"), 0)\`
---
Created by Bebell Digital Solutions
Copy this template and customize for your needs!`;
            navigator.clipboard.writeText(templateText).then(() => {
                showToast('Complete Notion template copied to clipboard! üìã', 'success');
            }).catch(() => {
                showToast('Failed to copy template', 'error');
            });
        }
        function downloadNotionTemplate() {
            const templateContent = `PERSONAL FINANCE DASHBOARD - NOTION TEMPLATE
Created by Bebell Digital Solutions
=== QUICK SETUP GUIDE ===
1. PREPARATION
   - Create a new Notion page titled "Personal Finance Dashboard"
   - Set up the following databases with specified properties
2. DATABASE CREATION
   Follow the structure below for each database...
[Complete database structure and formulas included]
=== DATABASES ===
1. ACCOUNTS DATABASE
   Properties:
   - Account Name (Title)
   - Type (Select: Checking, Savings, Credit Card, Investment, Business)
   - Bank/Institution (Text)
   - Current Balance (Number, Currency format)
   - Credit Limit (Number, Currency format - for credit cards)
   - Status (Select: Active, Inactive, Closed)
   - Last Updated (Date)
2. TRANSACTIONS DATABASE
   Properties:
   - Date (Date)
   - Description (Title)
   - Category (Relation to Categories database)
   - Type (Select: Income, Expense, Transfer)
   - Amount (Number, Currency format)
   - Account (Relation to Accounts database)
   - Recurring (Checkbox)
   - Tags (Multi-select)
   - Notes (Text)
3. CATEGORIES & BUDGETS DATABASE
   Properties:
   - Category (Title)
   - Icon (Text - for emojis)
   - Monthly Budget (Number, Currency format)
   - Current Spent (Rollup from Transactions database)
   - Remaining (Formula: Monthly Budget - Current Spent)
   - Progress (Formula: Current Spent / Monthly Budget * 100)
   - Type (Select: Income, Expense)
   - Color (Text - hex color codes)
4. RECURRING TRANSACTIONS DATABASE
   Properties:
   - Description (Title)
   - Type (Select: Income, Expense)
   - Amount (Number, Currency format)
   - Frequency (Select: Weekly, Bi-weekly, Monthly, Quarterly, Annually)
   - Next Date (Date)
   - Account (Relation to Accounts database)
   - Category (Relation to Categories database)
   - Auto-Create (Checkbox)
   - Email Reminder (Checkbox)
   - Status (Select: Active, Paused, Cancelled)
   - End Date (Date)
   - Created Date (Created Time)
5. FINANCIAL GOALS DATABASE
   Properties:
   - Goal Name (Title)
   - Target Amount (Number, Currency format)
   - Current Amount (Number, Currency format)
   - Progress (Formula: Current Amount / Target Amount * 100)
   - Target Date (Date)
   - Monthly Required (Formula based on remaining amount and time)
   - Priority (Select: High, Medium, Low)
   - Status (Select: In Progress, Completed, On Hold, Cancelled)
   - Notes (Text)
=== USEFUL FORMULAS ===
For Categories Database:
- Remaining Budget: if(prop("Monthly Budget") > 0, prop("Monthly Budget") - prop("Current Spent"), 0)
- Progress Percentage: if(prop("Monthly Budget") > 0, round(prop("Current Spent") / prop("Monthly Budget") * 100), 0)
For Goals Database:
- Days Remaining: dateBetween(prop("Target Date"), now(), "days")
- Monthly Savings Required: if(prop("Target Date") > now(), (prop("Target Amount") - prop("Current Amount")) / dateBetween(prop("Target Date"), now(), "months"), 0)
=== DASHBOARD VIEWS ===
Create these views for easy management:
1. Monthly Overview
   - Filter: Date is within current month
   - Group by: Category
   - Show: Total income vs expenses
2. Budget Tracker
   - Filter: Categories with budgets > 0
   - Sort by: Progress percentage (descending)
   - Show: Budget vs actual spending
3. Recurring Manager
   - Filter: Status is Active
   - Sort by: Next Date
   - Show: Upcoming recurring transactions
4. Goals Dashboard
   - Filter: Status is "In Progress"
   - Sort by: Priority, then Target Date
   - Show: Progress bars and required monthly savings
=== PRO TIPS ===
- Update account balances weekly
- Set realistic monthly budgets based on 3-month averages
- Use consistent category names
- Set up recurring transactions for all regular income/expenses
- Review and adjust goals quarterly
- Use tags for detailed transaction analysis
- Export data monthly for backup
For support and updates, visit: https://bebelldigital.com`;
            const blob = new Blob([templateContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Notion_Financial_Dashboard_Template.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showToast('Template downloaded successfully! üì•', 'success');
        }
        // Enhanced navigation to include recurring section
        function showSection(sectionName) {
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.add('hidden'));
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
                targetSection.classList.add('fade-in');
            }
            const navItems = document.querySelectorAll('.nav-item, .mobile-nav-item');
            navItems.forEach(item => {
                item.classList.remove('active', 'bg-primary-50', 'dark:bg-primary-900', 'text-primary-700', 'dark:text-primary-300');
                item.classList.add('text-gray-700', 'dark:text-gray-300');
            });
            const activeNavItems = document.querySelectorAll(`[onclick*="showSection('${sectionName}')"]`);
            activeNavItems.forEach(item => {
                item.classList.add('active', 'bg-primary-50', 'dark:bg-primary-900', 'text-primary-700', 'dark:text-primary-300');
                item.classList.remove('text-gray-700', 'dark:text-gray-300');
            });
            currentSection = sectionName;
            loadSectionData(sectionName);
        }
        function loadSectionData(sectionName) {
            switch(sectionName) {
                case 'overview':
                    loadOverviewData();
                    break;
                case 'recurring':
                    loadRecurringSection();
                    break;
                case 'accounts':
                    loadAccounts();
                    break;
                case 'transactions':
                    loadTransactions();
                    break;
                case 'budgets':
                    loadBudgets();
                    break;
                case 'reports':
                    loadReports();
                    break;
                case 'calendar':
                    loadCalendar();
                    break;
            }
        }
        // Enhanced form setup to include recurring
        function setupFormHandlers() {
            // Recurring form handler
            document.getElementById('recurring-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = {
                    type: document.getElementById('recurring-type').value,
                    amount: parseFloat(document.getElementById('recurring-amount').value),
                    description: document.getElementById('recurring-description').value,
                    category: document.getElementById('recurring-category').value,
                    account: parseInt(document.getElementById('recurring-account').value),
                    frequency: document.getElementById('recurring-frequency').value,
                    startDate: document.getElementById('recurring-start-date').value,
                    endDate: document.getElementById('recurring-end-date').value,
                    autoCreate: document.getElementById('recurring-auto-create').checked,
                    emailReminder: document.getElementById('recurring-email-reminder').checked
                };
                
                if (!formData.amount || !formData.description || !formData.account || !formData.startDate) {
                    showToast('Please fill in all required fields', 'error');
                    return;
                }
                
                const editId = this.dataset.editId;
                
                if (editId) {
                    financialData.updateRecurring(parseInt(editId), formData);
                    showToast('Recurring transaction updated successfully!', 'success');
                    delete this.dataset.editId;
                } else {
                    financialData.addRecurring(formData);
                    showToast('Recurring transaction added successfully!', 'success');
                }
                
                loadAllData();
                closeModal('add-recurring-modal');
                this.reset();
                document.getElementById('recurring-start-date').value = new Date().toISOString().split('T')[0];
            });
            // Keep all your existing form handlers here
        }
        // Currency formatting (keeping existing with DOP support)
        function formatCurrency(amount) {
            const currency = financialData.settings.currency || 'USD';
            let symbol, locale;
            
            switch(currency) {
                case 'USD': symbol = '$'; locale = 'en-US'; break;
                case 'EUR': symbol = '‚Ç¨'; locale = 'de-DE'; break;
                case 'GBP': symbol = '¬£'; locale = 'en-GB'; break;
                case 'JPY': symbol = '¬•'; locale = 'ja-JP'; break;
                case 'DOP': symbol = 'RD$'; locale = 'es-DO'; break;
                default: symbol = '$'; locale = 'en-US';
            }
            
            try {
                return new Intl.NumberFormat(locale, {
                    style: 'currency',
                    currency: currency,
                    minimumFractionDigits: currency === 'JPY' ? 0 : 2
                }).format(amount);
            } catch (error) {
                return `${symbol}${amount.toLocaleString('en-US', {
                    minimumFractionDigits: currency === 'JPY' ? 0 : 2,
                    maximumFractionDigits: currency === 'JPY' ? 0 : 2
                })}`;
            }
        }
        function formatDate(dateString) {
            const date = new Date(dateString);
            const format = financialData.settings.dateFormat || 'MM/DD/YYYY';
            
            if (format === 'DD/MM/YYYY') {
                return date.toLocaleDateString('en-GB');
            } else if (format === 'YYYY-MM-DD') {
                return date.toISOString().split('T')[0];
            } else {
                return date.toLocaleDateString('en-US');
            }
        }
        // Keep all your existing functions (theme, modal, toast, etc.)
        function applyTheme() {
            if (isDarkMode) {
                document.documentElement.classList.add('dark');
                document.getElementById('theme-icon').setAttribute('data-lucide', 'moon');
            } else {
                document.documentElement.classList.remove('dark');
                document.getElementById('theme-icon').setAttribute('data-lucide', 'sun');
            }
            lucide.createIcons();
        }
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
            applyTheme();
            setTimeout(() => initCharts(), 100);
        }
        function toggleMobileMenu() {
            const overlay = document.getElementById('mobile-overlay');
            const sidebar = document.getElementById('mobile-sidebar');
            const menuIcon = document.getElementById('mobile-menu-icon');
            if (overlay.classList.contains('hidden')) {
                overlay.classList.remove('hidden');
                sidebar.classList.remove('-translate-x-full');
                menuIcon.setAttribute('data-lucide', 'x');
            } else {
                overlay.classList.add('hidden');
                sidebar.classList.add('-translate-x-full');
                menuIcon.setAttribute('data-lucide', 'menu');
            }
            
            lucide.createIcons();
        }
        function showModal(modalId) {
            document.getElementById('modal-backdrop').classList.remove('hidden');
            document.getElementById(modalId).classList.remove('hidden');
            
            setTimeout(() => {
                const firstInput = document.querySelector(`#${modalId} input, #${modalId} select`);
                if (firstInput) firstInput.focus();
            }, 100);
        }
        function closeModal(modalId) {
            document.getElementById('modal-backdrop').classList.add('hidden');
            document.getElementById(modalId).classList.add('hidden');
        }
        function closeAllModals() {
            document.getElementById('modal-backdrop').classList.add('hidden');
            const modals = document.querySelectorAll('[id$="-modal"]');
            modals.forEach(modal => modal.classList.add('hidden'));
        }
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            
            toastMessage.textContent = message;
            
            toast.className = 'toast show px-6 py-3 rounded-lg shadow-lg';
            if (type === 'success') {
                toast.classList.add('bg-green-500', 'text-white');
            } else if (type === 'error') {
                toast.classList.add('bg-red-500', 'text-white');
            } else if (type === 'info') {
                toast.classList.add('bg-blue-500', 'text-white');
            }
            
            setTimeout(() => {
                toast.classList.remove('show');
                toast.classList.add('hide');
            }, 3000);
        }
        function loadOverviewData() {
            const totalBalance = financialData.accounts.reduce((sum, account) => sum + account.balance, 0);
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            
            const monthlyIncome = financialData.transactions
                .filter(t => {
                    const tDate = new Date(t.date);
                    return t.type === 'income' && 
                           tDate.getMonth() === currentMonth && 
                           tDate.getFullYear() === currentYear;
                })
                .reduce((sum, t) => sum + Math.abs(t.amount), 0);
                
            const monthlyExpenses = financialData.transactions
                .filter(t => {
                    const tDate = new Date(t.date);
                    return t.type === 'expense' && 
                           tDate.getMonth() === currentMonth && 
                           tDate.getFullYear() === currentYear;
                })
                .reduce((sum, t) => sum + Math.abs(t.amount), 0);
            const activeRecurring = financialData.recurring.filter(r => r.isActive).length;
            // Update UI
            document.getElementById('total-balance').textContent = formatCurrency(totalBalance);
            document.getElementById('monthly-income').textContent = formatCurrency(monthlyIncome);
            document.getElementById('monthly-expenses').textContent = formatCurrency(monthlyExpenses);
            document.getElementById('active-recurring').textContent = activeRecurring;
            // Load recent transactions and goals
            loadRecentTransactions();
            loadFinancialGoals();
        }
        function loadRecentTransactions() {
            const container = document.getElementById('recent-transactions');
            const recentTransactions = financialData.transactions
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5);
            
            if (recentTransactions.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                        <i data-lucide="credit-card" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                        <p>No transactions yet. Add your first transaction to get started!</p>
                    </div>
                `;
            } else {
                container.innerHTML = recentTransactions.map(transaction => {
                    const account = financialData.accounts.find(a => a.id === transaction.account);
                    const isExpense = transaction.type === 'expense';
                    const amountClass = isExpense ? 'text-danger-600 dark:text-danger-400' : 'text-success-600 dark:text-success-400';
                    const recurringBadge = transaction.isRecurring ? '<span class="ml-2 text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded-full">üîÑ Recurring</span>' : '';
                    
                    return `
                        <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-gray-100 dark:bg-gray-600 rounded-lg flex items-center justify-center mr-3">
                                    <i data-lucide="${getTransactionIcon(transaction.type)}" class="w-5 h-5 text-gray-600 dark:text-gray-400"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-900 dark:text-white">${transaction.description}${recurringBadge}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">${account?.name || 'Unknown Account'} ‚Ä¢ ${formatDate(transaction.date)}</p>
                                </div>
                            </div>
                            <p class="font-semibold ${amountClass}">${formatCurrency(Math.abs(transaction.amount))}</p>
                        </div>
                    `;
                }).join('');
            }
            lucide.createIcons();
        }
        function loadFinancialGoals() {
            const container = document.getElementById('financial-goals');
            
            if (financialData.goals.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500 dark:text-gray-400 col-span-full">
                        <i data-lucide="target" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                        <p>No goals set yet. Add your first financial goal!</p>
                    </div>
                `;
            } else {
                container.innerHTML = financialData.goals.map(goal => {
                    const progress = goal.target > 0 ? (goal.current / goal.target * 100).toFixed(1) : 0;
                    
                    return `
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-medium text-gray-900 dark:text-white">${goal.name}</h4>
                                <span class="text-sm text-gray-500 dark:text-gray-400">${progress}%</span>
                            </div>
                            <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2 mb-2">
                                <div class="bg-primary-600 h-2 rounded-full progress-bar" style="width: ${progress}%"></div>
                            </div>
                            <div class="flex justify-between text-sm text-gray-500 dark:text-gray-400">
                                <span>${formatCurrency(goal.current)}</span>
                                <span>${formatCurrency(goal.target)}</span>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }
        function getTransactionIcon(type) {
            const icons = {
                'income': 'arrow-down-left',
                'expense': 'arrow-up-right',
                'transfer': 'arrow-right-left'
            };
            return icons[type] || 'circle';
        }
        // Initialize the application when the page loads
        function init() {
            applyTheme();
            
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('transaction-date').value = today;
            document.getElementById('recurring-start-date').value = today;
            
            loadAllData();
            populateDropdowns();
            lucide.createIcons();
            
            setTimeout(() => initCharts(), 100);
            setupFormHandlers();
            loadSettings();
            initializeEmailJS();
            setupEmailNotificationToggle();
            
            // Process recurring transactions
            financialData.processRecurringTransactions();
            
            // Set up daily check for recurring transactions
            setInterval(() => {
                financialData.processRecurringTransactions();
            }, 24 * 60 * 60 * 1000);
        }
        // Placeholder functions for existing features (keep your existing implementations)
        function loadAllData() {
            loadOverviewData();
            loadRecurringSection();
            // Add calls to load other sections
        }
        function populateDropdowns() {
            // Populate category dropdowns for recurring form too
            const categorySelects = document.querySelectorAll('#transaction-category, #recurring-category, #transaction-category-filter');
            categorySelects.forEach(select => {
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = '<option value="">Select Category</option>' +
                        financialData.categories.map(category => 
                            `<option value="${category.name}">${category.name}</option>`
                        ).join('');
                    select.value = currentValue;
                }
            });
            // Populate account dropdowns for recurring form too
            const accountSelects = document.querySelectorAll('#transaction-account, #recurring-account, #transaction-account-filter');
            accountSelects.forEach(select => {
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = '<option value="">Select Account</option>' +
                        financialData.accounts.map(account => 
                            `<option value="${account.id}">${account.name}</option>`
                        ).join('');
                    select.value = currentValue;
                }
            });
        }
        function initCharts() { /* Your existing chart initialization */ }
        function loadSettings() { /* Your existing settings loading */ }
        function initializeEmailJS() { /* Your existing EmailJS initialization */ }
        function setupEmailNotificationToggle() { /* Your existing email toggle setup */ }
        function loadAccounts() { /* Your existing accounts loading */ }
        function loadTransactions() { /* Your existing transactions loading */ }
        function loadBudgets() { /* Your existing budgets loading */ }
        function loadReports() { /* Your existing reports loading */ }
        function loadCalendar() { /* Your existing calendar loading */ }
        function openAddTransactionModal() { /* Your existing function */ }
        function openAddGoalModal() { /* Your existing function */ }
        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', init);
        // Handle system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
            if (financialData.settings.theme === 'system') {
                isDarkMode = e.matches;
                applyTheme();
                setTimeout(() => initCharts(), 100);
            }
        });
    </script>
</body>
</html>

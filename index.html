<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Dashboard - Personal & Business Finance Management</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#fdf2f8',
                            100: '#fce7f3',
                            200: '#fbcfe8',
                            300: '#f9a8d4',
                            400: '#f472b6',
                            500: '#ec4899',
                            600: '#DF1783',
                            700: '#be185d',
                            800: '#9d174d',
                            900: '#831843'
                        },
                        success: {
                            600: '#059669',
                            700: '#047857'
                        },
                        warning: {
                            600: '#ea580c',
                            700: '#c2410c'
                        },
                        danger: {
                            600: '#dc2626',
                            700: '#b91c1c'
                        }
                    }
                }
            },
            darkMode: 'class'
        }
    </script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- Chart.js for Financial Charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- EmailJS for Email Notifications -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    
    
    <style>
    
        .custom-image-widget {
  position: fixed !important;
  top: 70px !important;  /* Verify this value isn't too large */
  margin: 0 !important;
  padding: 0 !important;
    right: 0px; /* Add spacing from the edge */
        z-index: 999;
}
  
    .custom-image {
        width: 70px;
        height: auto;
       transition: transform 0.2s;
    }
    
    
      .custom-image-widget:hover .custom-image {
        transform: scale(1.05); /* Slight zoom effect */
    }  
 
 
     .custom-image-widget:hover .tooltip {
        visibility: visible;
        opacity: 1;
    }
 

    
        .sidebar-transition {
            transition: transform 0.3s ease-in-out;
        }
        
        .card-hover {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .progress-bar {
            transition: width 0.5s ease-in-out;
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
       
       
        /* Footer Styles - Positioned in Main Content Area */
        .footer-main-content {
            position: relative;
            width: 100%;
            background-color: transparent;
        }
        

        
        .footer-text-centered {
            font-size: 10px;
            color: #666;
            margin: 30px 0;
            line-height: 1.4;
            display: block;
        }
        
        /* Dark mode footer text */
        .dark .footer-text-centered {
            color: #9ca3af;
        }
        
        /* Responsive footer */
        @media (max-width: 1024px) {
            .footer-main-content {
                margin-left: 0; /* Remove left margin on mobile */
            }
        }
        
        @media (max-width: 768px) {
            .footer-text-centered {
                font-size: 11px;
                padding: 0 15px;
            }
            
            .footer-main-content {
                margin-top: 2rem;
                padding-top: 1rem;
            }
        }
       
       
        
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        
        .dark .custom-scrollbar::-webkit-scrollbar-track {
            background: #334155;
        }
        
        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #64748b;
        }
        
        
        
        
        /* Chart container */
        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
        }
        
        /* Theme toggle animation */
        .theme-toggle {
            transition: all 0.3s ease;
        }

        /* Toast notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .toast.hide {
            opacity: 0;
            transform: translateY(-20px);
        }

        /* Calendar events */
        .calendar-event {
            font-size: 0.6rem;
            padding: 1px 3px;
            border-radius: 2px;
            margin: 1px 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .event-income {
            background-color: #10b981;
            color: white;
        }
        
        .event-expense {
            background-color: #DF1783;
            color: white;
        }
        
        .event-bill {
            background-color: #f59e0b;
            color: white;
        }
        
        

        /* Notion template styling */
        .notion-template {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .notion-code {
            background-color: #f3f4f6;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #374151;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        
        .dark .notion-code {
            background-color: #374151;
            border-color: #4b5563;
            color: #f3f4f6;
        }
        
        /* Transaction recurring options animation */
        .recurring-options-enter {
            animation: slideIn 0.3s ease-out;
        }
        
   
   
   
   
           @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Date preview styling */
        .date-preview {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin-top: 12px;
            font-size: 14px;
        }
        
        .date-preview-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .date-preview-item:last-child {
            border-bottom: none;
        }
   
   
   
   
        
        
        
    </style>
</head>



<body class="min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300">



 <div class="custom-image-widget" style="position: relative; display: inline-block;"> <!-- ADD THESE STYLES -->
    <a href="https://elnegocio-digital.translate.goog/?_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en-US&_x_tr_pto=wapp">
        <img class="custom-image" 
             src="https://bucket.mlcdn.com/a/3336/3336910/images/138f14304ea21715dfae64ae5fe1d71b08c2d451.png" 
             alt="English Translation"
             style="display: block;"> <!-- Ensure image is block-level -->
    </a>

</div>




    <!-- Toast Notification -->
    <div id="toast" class="toast hide bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg">
        <span id="toast-message">Success!</span>
    </div>
    
    
    

    <!-- Mobile Menu Button -->
    <div class="lg:hidden fixed top-4 left-4 z-50">
        <button onclick="toggleMobileMenu()" class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 border border-gray-200 dark:border-gray-700">
            <i id="mobile-menu-icon" data-lucide="menu" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
        </button>
    </div>
    
    

    <!-- Theme Toggle Button -->
    <div class="fixed top-4 right-4 z-50">
        <button onclick="toggleTheme()" class="theme-toggle bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 border border-gray-200 dark:border-gray-700">
            <i id="theme-icon" data-lucide="sun" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i>
        </button>
    </div>
    
    
    
    
    
    

    <!-- Desktop Sidebar -->
    <div id="sidebar" class="hidden lg:block fixed left-0 top-0 h-full w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 shadow-lg overflow-y-auto z-10 custom-scrollbar">
        <div class="p-6">
        
        
        
            <!-- Logo and Header -->
            <div class="mb-8">
                <div class="w-12 h-12 bg-gradient-to-br from-pink-500 to-purple-600 rounded-lg flex items-center justify-center mb-4">
                    <i data-lucide="wallet" class="w-6 h-6 text-white"></i>
                </div>
                
                
                
                <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">
                    Financial Dashboard
                </h1>
                
                <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">
                    Your Complete Finance Management Hub.
                </p>
            </div>
            
            
            

            <!-- Navigation Menu -->
            <nav class="space-y-2 mb-8">
                <a href="#" onclick="showSection('overview')" class="nav-item active flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="layout-dashboard" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Overview</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('accounts')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="building-2" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Accounts</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('transactions')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="credit-card" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Transactions</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('budgets')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="pie-chart" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Budgets</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('reports')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="bar-chart" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Reports</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('calendar')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="calendar" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Calendar</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
                <a href="#" onclick="showSection('settings')" class="nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                    <i data-lucide="settings" class="w-4 h-4 mr-3"></i>
                    <span class="font-medium">Settings</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                </a>
            </nav>

            <!-- Quick Actions -->
            <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                <div class="mb-4">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-white mb-2">ðŸ’° Quick Actions</h3>
                    <div class="space-y-2">
                        <button onclick="openAddTransactionModal()" class="w-full bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i data-lucide="plus" class="w-4 h-4 mr-2"></i>
                            Add Transaction
                        </button>
                        <button onclick="openAddGoalModal()" class="w-full border border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 text-gray-700 dark:text-gray-300 font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i data-lucide="target" class="w-4 h-4 mr-2"></i>
                            Add Goal
                        </button>
                    </div>
                </div>
                
                
                <!-- Notion Template Button -->
                <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
                    <div class="mb-4">
                        <h3 class="text-sm font-semibold text-gray-900 dark:text-white mb-2">ðŸ“‹ Resources</h3>
                        <button onclick="openNotionTemplateModal()" class="w-full bg-pink-600 hover:bg-pink-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                            <i data-lucide="file-text" class="w-4 h-4 mr-2"></i>
                            Notion Template
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    



    <!-- Mobile Sidebar Overlay -->
    <div id="mobile-overlay" class="lg:hidden fixed inset-0 z-40 hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50" onclick="toggleMobileMenu()"></div>
        <div id="mobile-sidebar" class="sidebar-transition relative w-80 bg-white dark:bg-gray-800 h-full shadow-lg transform -translate-x-full">
            <!-- Copy of sidebar content for mobile -->
            
            
            <div class="p-6">
                <!-- Logo and Header -->
                <div class="mb-8">
                    <div class="w-12 h-12 bg-gradient-to-br from-primary-600 to-primary-600 rounded-lg flex items-center justify-center mb-4">
                        <i data-lucide="wallet" class="w-6 h-6 text-white"></i>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">
                        Financial Dashboard
                    </h1>
                    <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">
                        Your Complete Finance Management Hub.
                    </p>
                </div>




                <!-- Navigation Menu -->
                <nav class="space-y-2 mb-8">
                    <a href="#" onclick="showSection('overview'); toggleMobileMenu()" class="mobile-nav-item active flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="layout-dashboard" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Overview</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('accounts'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="building-2" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Accounts</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('transactions'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="credit-card" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Transactions</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('budgets'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="pie-chart" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Budgets</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('reports'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="bar-chart" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Reports</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('calendar'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="calendar" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Calendar</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                    <a href="#" onclick="showSection('settings'); toggleMobileMenu()" class="mobile-nav-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i data-lucide="settings" class="w-4 h-4 mr-3"></i>
                        <span class="font-medium">Settings</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 ml-auto"></i>
                    </a>
                </nav>

                <!-- Quick Actions -->
                <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                    <div class="mb-4">
                        <h3 class="text-sm font-semibold text-gray-900 dark:text-white mb-2">ðŸ’° Quick Actions</h3>
                        <div class="space-y-2">
                            <button onclick="openAddTransactionModal(); toggleMobileMenu()" class="w-full bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                                <i data-lucide="plus" class="w-4 h-4 mr-2"></i>
                                Add Transaction
                            </button>
                            <button onclick="openAddGoalModal(); toggleMobileMenu()" class="w-full border border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 text-gray-700 dark:text-gray-300 font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                                <i data-lucide="target" class="w-4 h-4 mr-2"></i>
                                Add Goal
                            </button>
                        </div>
                    </div>
                    
                    <!-- Notion Template Button -->
                    <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
                        <div class="mb-4">
                            <h3 class="text-sm font-semibold text-gray-900 dark:text-white mb-2">ðŸ“‹ Resources</h3>
                            <button onclick="openNotionTemplateModal(); toggleMobileMenu()" class="w-full bg-pink-600 hover:bg-pink-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center">
                                <i data-lucide="file-text" class="w-4 h-4 mr-2"></i>
                                Notion Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    
    
    
    
    
    
    
    
    

    <!-- Main Content -->
    <div class="lg:ml-80 min-h-screen">
        <div class="p-4 lg:p-8 pt-20 lg:pt-8">
        
        
        
        <!-- Overview Section -->
            <div id="overview-section" class="content-section fade-in">                
            <div class="max-w-6xl mx-auto">
                    <!-- Hero Section -->
                    <div class="text-center mb-12">
                    <br>
                        <h1 class="text-4xl lg:text-6xl font-bold text-gray-900 dark:text-white mb-6">
                         Financial
                            <span class="text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-600">
                                Overview
                            </span>
                        </h1>
                        
                        <p class="text-xl text-gray-600 max-w-3xl mx-auto dark:text-gray-400 mb-8">
Track your financial health, manage budgets, and achieve your financial goals.                        
</p>

                    </div>
                    
                    
                    
                    
                    
                    

                    <!-- Quick Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="card-hover rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
    <div class="flex items-center justify-between">
        <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Total Balance</p>
                                    <p class="text-2xl font-bold text-gray-900 dark:text-white" id="total-balance">$0.00</p>
                                </div>
                               
                               
                               <div class="w-12 h-12 rounded-lg flex items-center justify-center">
    <i data-lucide="wallet" class="w-6 h-6 text-primary-600 dark:text-primary-400"></i>
</div>
                            </div>
                        </div>
                        
                        
                        
                        
                        
                        
                        <div class="card-hover bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Monthly Income</p>
                                    <p class="text-2xl font-bold text-success-600 dark:text-success-400" id="monthly-income">$0.00</p>
                                </div>
                                <div class="w-12 h-12 bg-success-100 dark:bg-success-900 rounded-lg flex items-center justify-center">
                                    <i data-lucide="trending-up" class="w-6 h-6 text-success-600 dark:text-success-400"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-hover bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Monthly Expenses</p>
                                    <p class="text-2xl font-bold text-danger-600 dark:text-danger-400" id="monthly-expenses">$0.00</p>
                                </div>
                                <div class="w-12 h-12 bg-danger-100 dark:bg-danger-900 rounded-lg flex items-center justify-center">
                                    <i data-lucide="trending-down" class="w-6 h-6 text-danger-600 dark:text-danger-400"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-hover bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Savings Rate</p>
                                    <p class="text-2xl font-bold text-primary-600 dark:text-primary-400" id="savings-rate">0%</p>
                                </div>
                                <div class="w-12 h-12 bg-warning-100 dark:bg-warning-900 rounded-lg flex items-center justify-center">
                                    <i data-lucide="target" class="w-6 h-6 text-warning-600 dark:text-warning-400"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    
                    
                    
                    
                    
                    

                    <!-- Charts Section -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Spending Trends</h3>
                            <div class="chart-container">
                                <canvas id="spending-chart"></canvas>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Budget Overview</h3>
                            <div class="chart-container">
                                <canvas id="budget-chart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    
                    
                    
                    
                    
                    
                    
                    

                    <!-- Recent Transactions -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Recent Transactions</h3>
                            <button onclick="showSection('transactions')" class="text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-medium">View All</button>
                        </div>
                        <div id="recent-transactions" class="space-y-4">
                            <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                                <i data-lucide="credit-card" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                                <p>No transactions yet. Add your first transaction to get started!</p>
                            </div>
                        </div>
                    </div>
                    
                    
                    
                    
                    
                    

                    <!-- Financial Goals -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Financial Goals</h3>
                            <button onclick="openAddGoalModal()" class="text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-medium">Add Goal</button>
                        </div>
                        <div id="financial-goals" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                                <i data-lucide="target" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                                <p>No goals set yet. Add your first financial goal!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            

           </div>  
            
            
            
            

            <!-- Accounts Section -->
            <div id="accounts-section" class="content-section hidden fade-in">
                <div class="max-w-7xl mx-auto">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-2">Accounts</h1>
                            <p class="text-lg text-gray-600 dark:text-gray-400">Manage your financial accounts and track balances</p>
                        </div>
                        <button onclick="openAddAccountModal()" class="bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center">
                            <i data-lucide="plus" class="w-4 h-4 mr-2"></i>
                            Add Account
                        </button>
                    </div>

                    <div id="accounts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="text-center py-12 text-gray-500 dark:text-gray-400 col-span-full">
                            <i data-lucide="building-2" class="w-16 h-16 mx-auto mb-4 opacity-50"></i>
                            <p class="text-xl mb-2">No accounts yet</p>
                            <p>Add your first account to start tracking your finances!</p>
                            <button onclick="openAddAccountModal()" class="mt-4 bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                Add Account
                            </button>
                        </div>
                    </div>
                </div>
                
            </div>
            
            
            
            
            
            

            <!-- Transactions Section -->
            <div id="transactions-section" class="content-section hidden fade-in">
                <div class="max-w-7xl mx-auto">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-2">Transactions</h1>
                            <p class="text-lg text-gray-600 dark:text-gray-400">Track all your income and expenses</p>
                        </div>
                        <button onclick="openAddTransactionModal()" class="bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center mt-4 sm:mt-0">
                            <i data-lucide="plus" class="w-4 h-4 mr-2"></i>
                            Add Transaction
                        </button>
                    </div>
                    
                    
                    
                    

                    <!-- Filters -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Search</label>
                                <input type="text" id="transaction-search" placeholder="Search transactions..." 
                                       class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"
                                       onkeyup="filterTransactions()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Type</label>
                                <select id="transaction-type-filter" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"
                                        onchange="filterTransactions()">
                                    <option value="">All Types</option>
                                    <option value="income">Income</option>
                                    <option value="expense">Expense</option>
                                    <option value="transfer">Transfer</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Category</label>
                                <select id="transaction-category-filter" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"
                                        onchange="filterTransactions()">
                                    <option value="">All Categories</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Account</label>
                                <select id="transaction-account-filter" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"
                                        onchange="filterTransactions()">
                                    <option value="">All Accounts</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    
                    
             
                    

                    <!-- Transactions Table -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">All Transactions</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50 dark:bg-gray-900">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Date</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Description</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Category</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Account</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Amount</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="transactions-table-body" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <tr>
                                        <td colspan="6" class="px-6 py-12 text-center">
                                            <div class="text-gray-500 dark:text-gray-400">
                                                <i data-lucide="credit-card" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                                                <p class="text-lg mb-2">No transactions yet</p>
                                                <p>Start by adding your first transaction!</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                

            </div>
            
            
            
            
            
            
            

            <!-- Budgets Section -->
            <div id="budgets-section" class="content-section hidden fade-in">
                <div class="max-w-7xl mx-auto">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-2">Budgets</h1>
                            <p class="text-lg text-gray-600 dark:text-gray-400">Plan and monitor your spending by category</p>
                        </div>
                        <button onclick="openAddBudgetModal()" class="bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center">
                            <i data-lucide="plus" class="w-4 h-4 mr-2"></i>
                            Add Budget
                        </button>
                    </div>

                    <div id="budgets-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="text-center py-12 text-gray-500 dark:text-gray-400 col-span-full">
                            <i data-lucide="pie-chart" class="w-16 h-16 mx-auto mb-4 opacity-50"></i>
                            <p class="text-xl mb-2">No budgets set</p>
                            <p>Create your first budget to start tracking your spending!</p>
                            <button onclick="openAddBudgetModal()" class="mt-4 bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                Add Budget
                            </button>
                        </div>
                    </div>
                </div>
                         
            </div>
            
            
            
            
            
            
            

            <!-- Reports Section -->
            <div id="reports-section" class="content-section hidden fade-in">
                <div class="max-w-7xl mx-auto">
                    <div class="mb-8">
                        <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-2">Reports</h1>
                        <p class="text-lg text-gray-600 dark:text-gray-400">Analyze your financial performance and trends</p>
                    </div>
                    
                    
                    
                    
                    
                    
                    
                    
                    

                    <!-- Report Filters -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Time Period</label>
                                <select id="report-period" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                                    <option value="month">This Month</option>
                                    <option value="quarter">This Quarter</option>
                                    <option value="year">This Year</option>
                                    <option value="custom">Custom Range</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Report Type</label>
                                <select id="report-type" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                                    <option value="income-expense">Income vs Expenses</option>
                                    <option value="category-breakdown">Category Breakdown</option>
                                    <option value="account-summary">Account Summary</option>
                                    <option value="budget-performance">Budget Performance</option>
                                </select>
                            </div>
                            <div class="flex items-end">
                                <button onclick="generateReport()" class="w-full bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                    Generate Report
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    
                    
                    
                    
                    
                    

                    <!-- Report Charts -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Income vs Expenses</h3>
                            <div class="chart-container">
                                <canvas id="income-expense-chart"></canvas>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Category Distribution</h3>
                            <div class="chart-container">
                                <canvas id="category-distribution-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
            
            
            
            
            
            
            

            <!-- Calendar Section -->
            <div id="calendar-section" class="content-section hidden fade-in">
                <div class="max-w-7xl mx-auto">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-2">Financial Calendar</h1>
                            <p class="text-lg text-gray-600 dark:text-gray-400">Track bills, goals, and financial events</p>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="exportCalendar('google')" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center">
                                <i data-lucide="calendar-plus" class="w-4 h-4 mr-2"></i>
                                Sync to Google
                            </button>
                            <button onclick="exportCalendar('ical')" class="bg-purple-600 hover:bg-purple-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center">
                                <i data-lucide="download" class="w-4 h-4 mr-2"></i>
                                Export iCal
                            </button>
                        </div>
                    </div>
                    
                    
                    
                    
                    
                    
                    
                    

                    <!-- Calendar Navigation -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <button onclick="previousMonth()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
                                <i data-lucide="chevron-left" class="w-5 h-5 text-gray-600 dark:text-gray-400"></i>
                            </button>
                            <h2 id="calendar-month-year" class="text-xl font-semibold text-gray-900 dark:text-white"></h2>
                            <button onclick="nextMonth()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
                                <i data-lucide="chevron-right" class="w-5 h-5 text-gray-600 dark:text-gray-400"></i>
                            </button>
                        </div>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <!-- Calendar Grid -->
                        <div class="grid grid-cols-7 gap-1">
                            <div class="p-2 text-center text-sm font-medium text-gray-500 dark:text-gray-400">Sun</div>
                            <div class="p-2 text-center text-sm font-medium text-gray-500 dark:text-gray-400">Mon</div>
                            <div class="p-2 text-center text-sm font-medium text-gray-500 dark:text-gray-400">Tue</div>
                            <div class="p-2 text-center text-sm font-medium text-gray-500 dark:text-gray-400">Wed</div>
                            <div class="p-2 text-center text-sm font-medium text-gray-500 dark:text-gray-400">Thu</div>
                            <div class="p-2 text-center text-sm font-medium text-gray-500 dark:text-gray-400">Fri</div>
                            <div class="p-2 text-center text-sm font-medium text-gray-500 dark:text-gray-400">Sat</div>
                        </div>
                        <div id="calendar-grid" class="grid grid-cols-7 gap-1 mt-2">
                        
                        
                        
                            <!-- Calendar days will be populated here -->
                        </div>
                    </div>
                    
                    
                    
                    
                    
                    

                    <!-- Upcoming Events -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Upcoming Bills</h3>
                            <div id="upcoming-bills" class="space-y-4">
                                <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                                    <i data-lucide="calendar-check" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                                    <p>No upcoming bills</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Goal Milestones</h3>
                            <div id="goal-milestones" class="space-y-4">
                                <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                                    <i data-lucide="target" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                                    <p>No goal milestones</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                                                  <div>
   </div>
            
            
            
            
            
            
            
            

            <!-- Settings Section -->
            <div id="settings-section" class="content-section hidden fade-in">
                <div class="max-w-4xl mx-auto">
                    <div class="mb-8">
                        <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-2">Settings</h1>
                        <p class="text-lg text-gray-600 dark:text-gray-400">Customize your dashboard preferences</p>
                    </div>

                    <!-- Settings Tabs -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                        <div class="border-b border-gray-200 dark:border-gray-700">
                            <nav class="flex space-x-8 px-6" aria-label="Tabs">
                                <button onclick="showSettingsTab('general')" class="settings-tab active py-4 px-1 border-b-2 border-primary-500 font-medium text-sm text-primary-600 dark:text-primary-400">
                                    General
                                </button>
                                <button onclick="showSettingsTab('notifications')" class="settings-tab py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                                    Notifications
                                </button>
                                <button onclick="showSettingsTab('security')" class="settings-tab py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                                    Security
                                </button>
                                <button onclick="showSettingsTab('data')" class="settings-tab py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                                    Data
                                </button>
                            </nav>
                        </div>






                        <!-- General Settings -->
                        <div id="general-settings" class="settings-content p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">General Preferences</h3>
                            <div class="space-y-6">
                                
                                
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Theme</label>
                                    <select id="theme-select" class="w-full max-w-md px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" onchange="handleThemeChange()">
                                        <option value="system">System</option>
                                        <option value="light">Light</option>
                                        <option value="dark">Dark</option>
                                    </select>
                                </div>
                                
                                
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Currency</label>
                                    <select id="currency-select" class="w-full max-w-md px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" onchange="handleCurrencyChange()">
                                        <option value="USD">USD ($)</option>
                                        <option value="EUR">EUR (â‚¬)</option>
                                        <option value="GBP">GBP (Â£)</option>
                                        <option value="JPY">JPY (Â¥)</option>
                                        <option value="DOP">DOP (RD$)</option>
                                    </select>
                                </div>
                                
                                
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Date Format</label>
                                    <select id="date-format-select" class="w-full max-w-md px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" onchange="handleDateFormatChange()">
                                        <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                        <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                                        <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                                    </select>
                                </div>
                            </div>


						</div>
                        
                        
                        
                        
                        
                        
                        
                        

                        <!-- Notifications Settings -->
                        <div id="notifications-settings" class="settings-content p-6 hidden">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Notification Preferences</h3>
                            <div class="space-y-6">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Budget Alerts</label>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Get notified when you're close to budget limits</p>
                                    </div>
                                    <input type="checkbox" id="budget-alerts" checked class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500">
                                </div>
                                <div class="flex items-center justify-between">
                                    <div>
                                        <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Bill Reminders</label>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Receive reminders for upcoming bills</p>
                                    </div>
                                    <input type="checkbox" id="bill-reminders" checked class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500">
                                </div>
                                <div class="flex items-center justify-between">
                                    <div>
                                        <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Goal Progress</label>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Updates on financial goal achievements</p>
                                    </div>
                                    <input type="checkbox" id="goal-progress" checked class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500">
                                </div>
                                <div class="flex items-center justify-between">
                                    <div>
                                        <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Email Notifications</label>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Receive email reminders and alerts</p>
                                    </div>
                                    <input type="checkbox" id="email-notifications" class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500">
                                </div>
                                <div id="email-settings" class="ml-6 space-y-4 hidden">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email Address</label>
                                        <input type="email" id="notification-email" placeholder="your-email@example.com"
                                               class="w-full max-w-md px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Notification Frequency</label>
                                        <select id="notification-frequency" class="w-full max-w-md px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                                            <option value="immediate">Immediate</option>
                                            <option value="daily">Daily Summary</option>
                                            <option value="weekly">Weekly Summary</option>
                                        </select>
                                    </div>
                                    <button onclick="setupEmailNotifications()" class="bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                        Setup Email Notifications
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        
                        
                        
                        
                        
                        
                        

                        <!-- Security Settings -->
                        <div id="security-settings" class="settings-content p-6 hidden">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Security</h3>
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Change Password</label>
                                    <button onclick="showToast('Password change feature coming soon!', 'info')" class="bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                        Update Password
                                    </button>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div>
                                        <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Two-Factor Authentication</label>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Add an extra layer of security</p>
                                    </div>
                                    <input type="checkbox" id="two-factor" class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500">
                                </div>
                            </div>
                        
  
                        </div>








                        <!-- Data Settings -->
                        <div id="data-settings" class="settings-content p-6 hidden">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Data Management</h3>
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Export Data</label>
                                    <div class="flex space-x-4">
                                        <button onclick="exportData('csv')" class="bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                            Export CSV
                                        </button>
                                        <button onclick="exportData('pdf')" class="border border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 text-gray-700 dark:text-gray-300 font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                            Export PDF
                                        </button>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Import Data</label>
                                    <input type="file" id="import-file" accept=".csv" class="w-full max-w-md px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" onchange="importData()">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Reset Data</label>
                                    <button onclick="resetAllData()" class="bg-danger-600 hover:bg-danger-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                        Reset All Data
                                    </button>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">This will delete all your accounts, transactions, and goals.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    
    
    
    

    <!-- Modal Backdrop -->
    <div id="modal-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden" onclick="closeAllModals()"></div>

    <!-- Add Transaction Modal -->
    <div id="add-transaction-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Add Transaction</h3>
                    <button onclick="closeModal('add-transaction-modal')" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                
                
                
  
                <form id="transaction-form" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Type</label>
                        <select id="transaction-type" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" required>
                            <option value="expense">Expense</option>
                            <option value="income">Income</option>
                            <option value="transfer">Transfer</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Amount</label>
                        <input type="number" id="transaction-amount" step="0.01" min="0" placeholder="0.00" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Description</label>
                        <input type="text" id="transaction-description" placeholder="Transaction description" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Category</label>
                        <select id="transaction-category" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" required>
                            <option value="">Select Category</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Account</label>
                        <select id="transaction-account" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" required>
                            <option value="">Select Account</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Date</label>
                        <input type="date" id="transaction-date" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    
                    
                    
                    
                    <div class="mt-4">
  <div class="flex items-center">
    <input type="checkbox" id="transaction-recurring" class="mr-2">
    <label for="transaction-recurring" class="text-sm font-medium text-gray-700 dark:text-gray-300">Recurring Transaction</label>
  </div>
</div>



<div id="recurring-options" class="hidden mt-4">
  <div>
    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Frequency</label>
    <select id="transaction-frequency" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
      <option value="daily">Daily</option>
      <option value="weekly">Weekly</option>
      <option value="monthly" selected>Monthly</option>
      <option value="yearly">Yearly</option>
    </select>
  </div>
  <div class="mt-4">
    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Number of Occurrences</label>
    <input type="number" id="transaction-times" min="1" max="100" value="12" 
           class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
  </div>
</div>
                    
                    
                    
                    
                    
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" onclick="closeModal('add-transaction-modal')" 
                                class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                            Cancel
                        </button>
                        <button type="submit" 
                                class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg">
                            Add Transaction
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>







    <!-- Add Account Modal -->
    <div id="add-account-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Add Account</h3>
                    <button onclick="closeModal('add-account-modal')" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                <form id="account-form" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Account Name</label>
                        <input type="text" id="account-name" placeholder="e.g., Main Checking" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Account Type</label>
                        <select id="account-type" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white" required>
                            <option value="">Select Type</option>
                             <option value="investment">Cash</option>
                            <option value="checking">Checking</option>
                            <option value="savings">Savings</option>
                            <option value="business">Business</option>
                            <option value="credit">Credit Card</option>
                            <option value="investment">Investment</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Bank/Institution</label>
                        <input type="text" id="account-bank" placeholder="e.g., Chase Bank" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Initial Balance</label>
                        <input type="number" id="account-balance" step="0.01" placeholder="0.00" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div id="credit-limit-field" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Credit Limit</label>
                        <input type="number" id="account-limit" step="0.01" placeholder="0.00"
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" onclick="closeModal('add-account-modal')" 
                                class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                            Cancel
                        </button>
                        <button type="submit" 
                                class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg">
                            Add Account
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    
    
    

    <!-- Add Budget Modal -->
    <div id="add-budget-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Add Budget</h3>
                    <button onclick="closeModal('add-budget-modal')" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                <form id="budget-form" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Category</label>
                        <input type="text" id="budget-category" placeholder="e.g., Food & Dining" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Monthly Budget</label>
                        <input type="number" id="budget-amount" step="0.01" min="0" placeholder="0.00" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Color</label>
                        <input type="color" id="budget-color" value="#DF1783" 
                               class="w-full h-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500">
                    </div>
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" onclick="closeModal('add-budget-modal')" 
                                class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                            Cancel
                        </button>
                        <button type="submit" 
                                class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg">
                            Add Budget
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    
    
    
    

    <!-- Add Goal Modal -->
    <div id="add-goal-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Add Financial Goal</h3>
                    <button onclick="closeModal('add-goal-modal')" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                <form id="goal-form" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Goal Name</label>
                        <input type="text" id="goal-name" placeholder="e.g., Emergency Fund" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Target Amount</label>
                        <input type="number" id="goal-target" step="0.01" min="0" placeholder="0.00" required
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Current Amount</label>
                        <input type="number" id="goal-current" step="0.01" min="0" placeholder="0.00"
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Target Date</label>
                        <input type="date" id="goal-deadline" 
                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" onclick="closeModal('add-goal-modal')" 
                                class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                            Cancel
                        </button>
                        <button type="submit" 
                                class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg">
                            Add Goal
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>







       <!-- Notion Template Modal -->
    <div id="notion-template-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full p-6 max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">ðŸ“‹ Notion Financial Template - Enhanced DOP Support</h3>
                    <button onclick="closeModal('notion-template-modal')" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                
                <div class="notion-template bg-gray-50 dark:bg-gray-700 rounded-lg p-6 mb-6">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="file-text" class="w-8 h-8 text-blue-600 dark:text-blue-400"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Enhanced Finance Template with DOP Support</h2>
                        <p class="text-gray-600 dark:text-gray-300">Complete Notion template with Dominican Peso (DOP) currency support and recurring transaction formulas</p>
                    </div>

                    <div class="space-y-6">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">ðŸŽ¯ What's Included:</h3>
                            <ul class="list-disc list-inside space-y-2 text-gray-700 dark:text-gray-300">
                                <li>Complete database setup with DOP currency formatting (RD$)</li>
                                <li>Recurring transaction formulas using dateAdd functions</li>
                                <li>Budget tracking with visual progress indicators</li>
                                <li>Monthly and yearly financial reports</li>
                                <li>Goal tracking and milestone management</li>
                                <li>Expense categorization system</li>
                                <li>Income and expense analysis templates</li>
                                <li>Enhanced formula readability with color coding</li>
                            </ul>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">ðŸš€ Enhanced Features:</h3>
                            <ul class="list-disc list-inside space-y-2 text-gray-700 dark:text-gray-300">
                                <li>Structured database properties in organized tables</li>
                                <li>Automatic recurring transaction calculations</li>
                                <li>Dominican Peso (DOP) currency format throughout</li>
                                <li>Visual hierarchy with improved markdown</li>
                                <li>Color coding support for quick identification</li>
                                <li>Emoji indicators for rapid scanning</li>
                            </ul>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">ðŸ“‹ Database Formulas:</h3>
                            <div class="notion-code">
# Budget Remaining Formula
if(prop("Monthly Budget") > 0, prop("Monthly Budget") - prop("Current Spent"), 0)

# Budget Progress Formula
if(prop("Monthly Budget") > 0, round(prop("Current Spent") / prop("Monthly Budget") * 100), 0)

# Days Until Target Formula
dateBetween(prop("Target Date"), now(), "days")

# Monthly Savings Required Formula
if(prop("Target Date") > now(), (prop("Target Amount") - prop("Current Amount")) / dateBetween(prop("Target Date"), now(), "months"), 0)

# Recurring Transaction Formula
dateAdd(prop("Last Payment Date"), prop("Frequency"), "months")
                            </div>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">ðŸ’° Currency Configuration:</h3>
                            <div class="bg-blue-50 dark:bg-blue-900 rounded-lg p-4">
                                <p class="text-blue-900 dark:text-blue-200 font-medium mb-2">Dominican Peso (DOP) Setup:</p>
                                <ul class="text-sm text-blue-800 dark:text-blue-300 space-y-1">
                                    <li>â€¢ Currency Symbol: RD$ (Dominican Peso)</li>
                                    <li>â€¢ Format: RD$ #,##0.00</li>
                                    <li>â€¢ All financial properties configured for DOP</li>
                                    <li>â€¢ Automatic calculation formulas included</li>
                                </ul>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">ðŸ”„ Recurring Transactions Setup:</h3>
                            <ol class="list-decimal list-inside space-y-2 text-gray-700 dark:text-gray-300">
                                <li>Create a "Frequency" property (select: Monthly, Weekly, Daily, Yearly)</li>
                                <li>Add "Last Payment Date" property (date format)</li>
                                <li>Add "Next Due Date" with formula: dateAdd(prop("Last Payment Date"), 1, prop("Frequency"))</li>
                                <li>Use automation to update dates when transactions are logged</li>
                            </ol>
                        </div>

                        <div class="bg-green-50 dark:bg-green-900 rounded-lg p-4">
                            <h4 class="font-semibold text-green-900 dark:text-green-200 mb-2">âœ¨ Key Improvements:</h4>
                            <ul class="text-sm text-green-800 dark:text-green-300 space-y-1">
                                <li>â€¢ Structured all database properties in organized tables</li>
                                <li>â€¢ Added recurring transaction formula using dateAdd</li>
                                <li>â€¢ Specified DOP currency format throughout</li>
                                <li>â€¢ Enhanced visual hierarchy with markdown</li>
                                <li>â€¢ Improved formula readability</li>
                                <li>â€¢ Added color coding support notes</li>
                                <li>â€¢ Added emoji indicators for quick scanning</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="flex justify-between items-center">
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        <p class="font-medium">Enhanced Template by Bebell Digital Solutions</p>
                        <p>Includes databases, formulas, DOP currency support, and automation</p>
                        <p class="text-xs mt-1">Version 2.0 - With Recurring Transactions & Dominican Peso Support</p>
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="copyTemplateText()" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center">
                            <i data-lucide="copy" class="w-4 h-4 mr-2"></i>
                            Copy Template
                        </button>
                        <a href="https://www.notion.so/templates/personal-finance-tracker" target="_blank" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center">
                            <i data-lucide="external-link" class="w-4 h-4 mr-2"></i>
                            Visit Notion
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    
    
    
    
    
    
    
    
    
    <!-- Add this right before the closing </body> tag, just before your existing script section -->
<div class="fixed bottom-0 right-0 w-full md:bottom-6 md:right-12 md:w-auto z-50" x-data="{ bannerOpen: true, videoOpen: false }" x-show="bannerOpen">
    <!-- Video Popup (hidden by default) -->
    <div x-show="videoOpen" class="fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4" @click.away="videoOpen = false">
        <div class="relative w-full max-w-4xl bg-white rounded-lg overflow-hidden">
            <!-- Close Button -->
            <button class="absolute top-2 right-2 z-50 text-white bg-black/50 hover:bg-black/75 rounded-full p-1" @click="videoOpen = false">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
                <span class="sr-only">Close video</span>
            </button>
            
            <div class="aspect-w-16 aspect-h-9">
                <iframe 
                    width="100%" 
                    height="100%" 
                    src="https://www.youtube.com/embed/YOUR_VIDEO_ID?autoplay=1" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen
                    class="w-full h-[300px] md:h-[500px]"
                ></iframe>
            </div>
        </div>
    </div>
    
    <!-- Banner Content -->
    <div class="bg-[#DF1783] text-sm p-3 md:rounded-lg shadow-lg flex justify-between">
        <div class="text-white inline-flex items-center">
            <!-- Your Logo Icon -->
            <img src="https://bucket.mlcdn.com/a/3336/3336910/images/0ebdbcd8dbd9c182ba5e477001c9e9d354d6b9ee.png" class="w-5 h-5 mr-2" alt="Bebell Digital Solutions Logo">
            
            <button class="font-medium hover:underline text-white" @click="videoOpen = true">
                Watch Tutorial
            </button>
            <span class="italic px-1.5">or</span>
            <a class="font-medium hover:underline text-white flex items-center" href="https://github.com/cruip/cruip-tutorials/blob/main/vertical-timelines/index.html" target="_blank" rel="noreferrer">
                <span>Download</span>
                <svg class="fill-white ml-1" xmlns="http://www.w3.org/2000/svg" width="9" height="9">
                    <path d="m1.649 8.514-.91-.915 5.514-5.523H2.027l.01-1.258h6.388v6.394H7.158l.01-4.226z" />
                </svg>
            </a>
        </div>
        <button class="text-white hover:text-slate-200 pl-2 ml-3 border-l border-white/30" @click="bannerOpen = false">
            <span class="sr-only">Close</span>
            <svg class="w-4 h-4 shrink-0 fill-current" viewBox="0 0 16 16">
                <path d="M12.72 3.293a1 1 0 00-1.415 0L8.012 6.586 4.72 3.293a1 1 0 00-1.414 1.414L6.598 8l-3.293 3.293a1 1 0 101.414 1.414l3.293-3.293 3.293 3.293a1 1 0 001.414-1.414L9.426 8l3.293-3.293a1 1 0 000-1.414z" />
            </svg>
        </button>
    </div>
</div>
 
 
 

           
            <!-- Footer Section -->
            <footer class="footer-main-content mt-16 pt-8 border-t border-gray-200 dark:border-gray-700">
                <div class="max-w-4xl mx-auto px-4">
                    <div class="footer-content-center">
                        <p class="footer-text-centered">
                            <br>Developed with ðŸ’– by Bebell Digital Solutions.<br>
                            Copyright Â© 2024 â€¢ All rights reserved
                        </p>
                    </div>
                </div>
            </footer>
 
 
 
 
 
    <!-- Alpine.js -->
<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    
    

    <!-- JavaScript -->
       <script>
        // Enhanced Data Storage with Calendar Integration
class FinancialData {
    constructor() {
        this.accounts = this.loadFromStorage('accounts', []);
        this.transactions = this.loadFromStorage('transactions', []);
        this.categories = this.loadFromStorage('categories', this.getDefaultCategories());
        this.goals = this.loadFromStorage('goals', []);
        this.settings = this.loadFromStorage('settings', this.getDefaultSettings());
        this.bills = this.loadFromStorage('bills', []);
    }

            
            
            
            

            loadFromStorage(key, defaultValue) {
                try {
                    const data = localStorage.getItem(`financialData_${key}`);
                    return data ? JSON.parse(data) : defaultValue;
                } catch (error) {
                    console.error(`Error loading ${key} from storage:`, error);
                    return defaultValue;
                }
            }

            saveToStorage(key, data) {
                try {
                    localStorage.setItem(`financialData_${key}`, JSON.stringify(data));
                } catch (error) {
                    console.error(`Error saving ${key} to storage:`, error);
                }
            }

            getDefaultCategories() {
                return [
                    { id: 1, name: "Housing", budget: 1500, color: "#3b82f6" },
                    { id: 2, name: "Food", budget: 600, color: "#10b981" },
                    { id: 3, name: "Transportation", budget: 300, color: "#f59e0b" },
                    { id: 4, name: "Utilities", budget: 200, color: "#8b5cf6" },
                    { id: 5, name: "Entertainment", budget: 150, color: "#ef4444" },
                    { id: 6, name: "Healthcare", budget: 300, color: "#06b6d4" },
                    { id: 7, name: "Shopping", budget: 250, color: "#84cc16" },
                    { id: 8, name: "Salary", budget: 0, color: "#059669" },
                    { id: 9, name: "Freelance", budget: 0, color: "#0ea5e9" },
                    { id: 10, name: "Other", budget: 100, color: "#6b7280" }
                ];
            }

            getDefaultSettings() {
                return {
                    theme: 'system',
                    currency: 'USD',
                    dateFormat: 'MM/DD/YYYY',
                    budgetAlerts: true,
                    billReminders: true,
                    goalProgress: true,
                    emailNotifications: false,
                    notificationEmail: '',
                    notificationFrequency: 'daily',
                    twoFactor: false
                };
            }
            
            
            
            
            

            // Account operations
            addAccount(account) {
                account.id = Date.now();
                this.accounts.push(account);
                this.saveToStorage('accounts', this.accounts);
                return account;
            }
            
            

            updateAccount(id, updates) {
                const index = this.accounts.findIndex(a => a.id === id);
                if (index !== -1) {
                    this.accounts[index] = { ...this.accounts[index], ...updates };
                    this.saveToStorage('accounts', this.accounts);
                    return this.accounts[index];
                }
                return null;
            }

            deleteAccount(id) {
                this.accounts = this.accounts.filter(a => a.id !== id);
                this.saveToStorage('accounts', this.accounts);
            }









            // Transaction operations
                addTransaction(transaction) {
        transaction.id = Date.now();
        this.transactions.push(transaction);
        
        // Update account balance
        const account = this.accounts.find(a => a.id === transaction.account);
        if (account) {
            if (transaction.type === 'expense') {
                account.balance -= Math.abs(transaction.amount);
            } else if (transaction.type === 'income') {
                account.balance += Math.abs(transaction.amount);
            }
            this.saveToStorage('accounts', this.accounts);
        }
        
        this.saveToStorage('transactions', this.transactions);
        return transaction;
    }

            
            
            
            updateTransaction(id, updates) {
                const index = this.transactions.findIndex(t => t.id === id);
                if (index !== -1) {
                    this.transactions[index] = { ...this.transactions[index], ...updates };
                    this.saveToStorage('transactions', this.transactions);
                    return this.transactions[index];
                }
                return null;
            }

            deleteTransaction(id) {
                const transaction = this.transactions.find(t => t.id === id);
                if (transaction) {
                
                
                
                    // Reverse account balance change
                    const account = this.accounts.find(a => a.id === transaction.account);
                    if (account) {
                        if (transaction.type === 'expense') {
                            account.balance += Math.abs(transaction.amount);
                        } else if (transaction.type === 'income') {
                            account.balance -= Math.abs(transaction.amount);
                        }
                        this.saveToStorage('accounts', this.accounts);
                    }
                }
                
                this.transactions = this.transactions.filter(t => t.id !== id);
                this.saveToStorage('transactions', this.transactions);
            }





            // Category operations
            addCategory(category) {
                category.id = Date.now();
                this.categories.push(category);
                this.saveToStorage('categories', this.categories);
                return category;
            }






            // Goal operations
            addGoal(goal) {
                goal.id = Date.now();
                this.goals.push(goal);
                this.saveToStorage('goals', this.goals);
                return goal;
            }

            updateGoal(id, updates) {
                const index = this.goals.findIndex(g => g.id === id);
                if (index !== -1) {
                    this.goals[index] = { ...this.goals[index], ...updates };
                    this.saveToStorage('goals', this.goals);
                    return this.goals[index];
                }
                return null;
            }

            deleteGoal(id) {
                this.goals = this.goals.filter(g => g.id !== id);
                this.saveToStorage('goals', this.goals);
            }






            // Settings operations
            updateSettings(updates) {
                this.settings = { ...this.settings, ...updates };
                this.saveToStorage('settings', this.settings);
            }
            
            
            
            
            

            // Bills operations
            addBill(bill) {
                bill.id = Date.now();
                this.bills.push(bill);
                this.saveToStorage('bills', this.bills);
                return bill;
            }
            
            
            
            

            // Clear all data
            clearAllData() {
                this.accounts = [];
                this.transactions = [];
                this.categories = this.getDefaultCategories();
                this.goals = [];
                this.bills = [];
                this.settings = this.getDefaultSettings();
                
                localStorage.removeItem('financialData_accounts');
                localStorage.removeItem('financialData_transactions');
                localStorage.removeItem('financialData_categories');
                localStorage.removeItem('financialData_goals');
                localStorage.removeItem('financialData_bills');
                localStorage.removeItem('financialData_settings');
            }
            
            
            
            
            
            

            // Get transactions for specific date
            getTransactionsForDate(date) {
                const dateStr = date.toISOString().split('T')[0];
                return this.transactions.filter(t => t.date === dateStr);   
                
                
            }
            
            
            

            // Get bills for specific date
            getBillsForDate(date) {
                const dateStr = date.toISOString().split('T')[0];
                return this.bills.filter(b => b.dueDate === dateStr);
            }
        }
        
        
        
        
        

  // Global variables
let financialData = new FinancialData();
let currentSection = 'overview';
let isDarkMode = localStorage.getItem('theme') === 'dark' || 
                (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches);
let currentMonth = new Date().getMonth();
let currentYear = new Date().getFullYear();
let charts = {};
let emailJS = null;

// Initialize the application
function init() {


            // Set initial theme
            applyTheme();
            
            // Set today's date for forms
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('transaction-date').value = today;
            
            // Load initial data
            loadAllData();
            populateDropdowns();
            
            // Initialize icons
            lucide.createIcons();

            // Initialize charts
            setTimeout(() => {
                initCharts();
            }, 100);

            // Set up form handlers
            setupFormHandlers();

            // Load settings
            loadSettings();

            // Initialize EmailJS
            initializeEmailJS();

            // Setup email notification toggle
            setupEmailNotificationToggle();
        }

        // 1. DOMINICAN PESOS (DOP) IMPLEMENTATION
        function formatCurrency(amount) {
            const currency = financialData.settings.currency || 'USD';
            let symbol, locale;
            
            switch(currency) {
                case 'USD':
                    symbol = '$';
                    locale = 'en-US';
                    break;
                case 'EUR':
                    symbol = 'â‚¬';
                    locale = 'de-DE';
                    break;
                case 'GBP':
                    symbol = 'Â£';
                    locale = 'en-GB';
                    break;
                case 'JPY':
                    symbol = 'Â¥';
                    locale = 'ja-JP';
                    break;
                case 'DOP':
                    symbol = 'RD$';
                    locale = 'es-DO';
                    break;
                default:
                    symbol = '$';
                    locale = 'en-US';
            }
            
            try {
                return new Intl.NumberFormat(locale, {
                    style: 'currency',
                    currency: currency,
                    minimumFractionDigits: currency === 'JPY' ? 0 : 2
                }).format(amount);
            } catch (error) {
                
                
                
                // Fallback for unsupported currencies
                return `${symbol}${amount.toLocaleString('en-US', {
                    minimumFractionDigits: currency === 'JPY' ? 0 : 2,
                    maximumFractionDigits: currency === 'JPY' ? 0 : 2
                })}`;
            }
        }

        
        
        
        
        
        // 2. CALENDAR SYNC IMPLEMENTATION
        function exportCalendar(type) {
            if (type === 'google') {
                exportToGoogleCalendar();
            } else if (type === 'ical') {
                exportToICalendar();
            }
        }

        function exportToGoogleCalendar() {
            const events = getAllCalendarEvents();
            if (events.length === 0) {
                showToast('No events to export', 'info');
                return;
            }

            
            
            
            // Create Google Calendar URLs for each event
            events.forEach(event => {
                const startDate = event.date.replace(/-/g, '');
                const endDate = startDate; // All day events
                const url = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(event.title)}&dates=${startDate}/${startDate}&details=${encodeURIComponent(event.description)}`;
                window.open(url, '_blank');
            });
            
            showToast('Opening Google Calendar for each event...', 'success');
        }

        function exportToICalendar() {
            const events = getAllCalendarEvents();
            if (events.length === 0) {
                showToast('No events to export', 'info');
                return;
            }

            let icalContent = [
                'BEGIN:VCALENDAR',
                'VERSION:2.0',
                'PRODID:-//Financial Dashboard//Financial Events//EN',
                'CALSCALE:GREGORIAN'
            ];

            events.forEach(event => {
                const startDate = event.date.replace(/-/g, '') + 'T120000Z';
                const endDate = event.date.replace(/-/g, '') + 'T130000Z';
                
                icalContent.push(
                    'BEGIN:VEVENT',
                    `UID:${event.id}@financialdashboard.com`,
                    `DTSTART:${startDate}`,
                    `DTEND:${endDate}`,
                    `SUMMARY:${event.title}`,
                    `DESCRIPTION:${event.description}`,
                    `CATEGORIES:${event.category}`,
                    'END:VEVENT'
                );
            });

            icalContent.push('END:VCALENDAR');

            const blob = new Blob([icalContent.join('\r\n')], { type: 'text/calendar' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'financial-events.ics';
            a.click();
            window.URL.revokeObjectURL(url);
            
            showToast('Calendar exported successfully!', 'success');
        }

        function getAllCalendarEvents() {
            const events = [];
            
           
           
           
           
           // Add transaction events
            financialData.transactions.forEach(transaction => {
                const account = financialData.accounts.find(a => a.id === transaction.account);
                events.push({
                    id: `transaction-${transaction.id}`,
                    title: `${transaction.type === 'expense' ? 'ðŸ“¤' : 'ðŸ“¥'} ${transaction.description}`,
                    date: transaction.date,
                    description: `${transaction.type.toUpperCase()}: ${formatCurrency(Math.abs(transaction.amount))} - ${transaction.category} (${account?.name || 'Unknown Account'})`,
                    category: 'Transaction'
                });
            });



            // Add bill reminders
            financialData.bills.forEach(bill => {
                events.push({
                    id: `bill-${bill.id}`,
                    title: `ðŸ’° Bill Due: ${bill.name}`,
                    date: bill.dueDate,
                    description: `Bill payment due: ${formatCurrency(bill.amount)}`,
                    category: 'Bill'
                });
            });
            
            
            

            // Add goal milestones
            financialData.goals.forEach(goal => {
                if (goal.deadline) {
                    events.push({
                        id: `goal-${goal.id}`,
                        title: `ðŸŽ¯ Goal Deadline: ${goal.name}`,
                        date: goal.deadline,
                        description: `Financial goal target: ${formatCurrency(goal.target)} (Current: ${formatCurrency(goal.current)})`,
                        category: 'Goal'
                    });
                }
            });

            return events;
        }
        
        
        
        

        // 3. TRANSACTIONS IN CALENDAR IMPLEMENTATION
        function loadCalendar() {
            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"];
            
            const monthYearElement = document.getElementById('calendar-month-year');
            if (monthYearElement) {
                monthYearElement.textContent = `${monthNames[currentMonth]} ${currentYear}`;
            }

            const calendarGrid = document.getElementById('calendar-grid');
            if (!calendarGrid) return;

            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            let calendarHTML = '';
            
            
            
            
            // Empty cells for days before the first day of the month
            for (let i = 0; i < firstDay; i++) {
                calendarHTML += '<div class="p-2 h-20"></div>';
            }
            
            // Days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const currentDate = new Date(currentYear, currentMonth, day);
                const isToday = new Date().getDate() === day && 
                               new Date().getMonth() === currentMonth && 
                               new Date().getFullYear() === currentYear;
                
                
                
                
                
                // Get events for this date
                const dayTransactions = financialData.getTransactionsForDate(currentDate);
                const dayBills = financialData.getBillsForDate(currentDate);
                
                let eventsHTML = '';
                
                // Add transaction events
                dayTransactions.forEach(transaction => {
                    const eventClass = transaction.type === 'income' ? 'event-income' : 'event-expense';
                    eventsHTML += `<div class="calendar-event ${eventClass}" title="${transaction.description} - ${formatCurrency(Math.abs(transaction.amount))}">${transaction.description.substring(0, 8)}...</div>`;
                });
                
                
                
                
                // Add bill events
                dayBills.forEach(bill => {
                    eventsHTML += `<div class="calendar-event event-bill" title="Bill: ${bill.name} - ${formatCurrency(bill.amount)}">ðŸ’° ${bill.name}</div>`;
                });
                
                calendarHTML += `
                    <div class="p-2 h-20 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer" onclick="showDayDetails('${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}')">
                        <div class="text-sm font-medium text-gray-900 dark:text-white ${isToday ? 'bg-primary-600 text-white rounded-full w-6 h-6 flex items-center justify-center' : ''}">${day}</div>
                        <div class="mt-1 space-y-1 overflow-hidden">
                            ${eventsHTML}
                        </div>
                    </div>
                `;
            }
            
            calendarGrid.innerHTML = calendarHTML;
            loadUpcomingEvents();
        }

        function showDayDetails(date) {
            const selectedDate = new Date(date);
            const transactions = financialData.getTransactionsForDate(selectedDate);
            const bills = financialData.getBillsForDate(selectedDate);
            
            if (transactions.length === 0 && bills.length === 0) {
                showToast('No events on this date', 'info');
                return;
            }
            
            let details = `Events for ${formatDate(date)}:\n\n`;
            
            transactions.forEach(t => {
                const account = financialData.accounts.find(a => a.id === t.account);
                details += `${t.type === 'income' ? 'ðŸ“¥' : 'ðŸ“¤'} ${t.description}\n`;
                details += `   Amount: ${formatCurrency(Math.abs(t.amount))}\n`;
                details += `   Category: ${t.category}\n`;
                details += `   Account: ${account?.name || 'Unknown'}\n\n`;
            });
            
            bills.forEach(b => {
                details += `ðŸ’° ${b.name}\n`;
                details += `   Amount: ${formatCurrency(b.amount)}\n`;
                details += `   Type: Bill Payment\n\n`;
            });
            
            alert(details);
        }

       // 4. NOTION TEMPLATE POPUP IMPLEMENTATION
        function openNotionTemplateModal() {
            showModal('notion-template-modal');
        }

        function copyTemplateText() {
            const templateText = `
# Enhanced Personal Finance Template with DOP Support

## ðŸš€ Quick Setup Guide:
1. Copy this template into a new Notion page
2. Create the databases following the table structures below
3. Configure currency to Dominican Peso (DOP) format: RD$ #,##0.00
4. Set up the formulas as specified
5. Delete existing sample data from each database
6. Add your accounts with initial balances
7. Set up your expense categories and monthly budgets
8. Start tracking your transactions with recurring options

## ðŸ’° Currency Configuration (Dominican Peso - DOP):
- Currency Symbol: RD$ (Dominican Peso)
- Format: RD$ #,##0.00
- All financial properties configured for DOP

## ðŸ“Š Database Structures:

### ðŸ“± Accounts Database
| Property | Type | Description |
|----------|------|-------------|
| Name | Title | Account name |
| Type | Select | Checking, Savings, Credit, Investment, Cash |
| Balance | Number (DOP) | Current balance in RD$ |
| Institution | Text | Bank or financial institution |
| Notes | Text | Additional notes |

### ðŸ’³ Transactions Database
| Property | Type | Description |
|----------|------|-------------|
| Description | Title | Transaction description |
| Amount | Number (DOP) | Amount in RD$ |
| Type | Select | Income, Expense, Transfer |
| Category | Relation | Link to Categories database |
| Account | Relation | Link to Accounts database |
| Date | Date | Transaction date |
| Recurring | Checkbox | Is this a recurring transaction? |
| Frequency | Select | Daily, Weekly, Monthly, Yearly |
| Next Due | Formula | dateAdd(prop("Date"), 1, prop("Frequency")) |

### ðŸ“‚ Categories Database
| Property | Type | Description |
|----------|------|-------------|
| Name | Title | Category name |
| Type | Select | Income, Expense |
| Budget | Number (DOP) | Monthly budget in RD$ |
| Color | Select | Visual identifier |
| Current Spent | Rollup | Sum of related transactions |
| Budget Remaining | Formula | if(prop("Budget") > 0, prop("Budget") - prop("Current Spent"), 0) |
| Budget Progress | Formula | if(prop("Budget") > 0, round(prop("Current Spent") / prop("Budget") * 100), 0) |

### ðŸŽ¯ Goals Database
| Property | Type | Description |
|----------|------|-------------|
| Name | Title | Goal name |
| Target Amount | Number (DOP) | Target amount in RD$ |
| Current Amount | Number (DOP) | Current saved amount in RD$ |
| Target Date | Date | Target completion date |
| Progress | Formula | round(prop("Current Amount") / prop("Target Amount") * 100) |
| Days Remaining | Formula | dateBetween(prop("Target Date"), now(), "days") |
| Monthly Required | Formula | if(prop("Target Date") > now(), (prop("Target Amount") - prop("Current Amount")) / dateBetween(prop("Target Date"), now(), "months"), 0) |

## ðŸ”„ Recurring Transaction Formulas:

### Next Due Date:
\`\`\`
dateAdd(prop("Last Payment Date"), 1, prop("Frequency"))
\`\`\`

### Budget Remaining:
\`\`\`
if(prop("Monthly Budget") > 0, prop("Monthly Budget") - prop("Current Spent"), 0)
\`\`\`

### Budget Progress Percentage:
\`\`\`
if(prop("Monthly Budget") > 0, round(prop("Current Spent") / prop("Monthly Budget") * 100), 0)
\`\`\`

### Days Until Target:
\`\`\`
dateBetween(prop("Target Date"), now(), "days")
\`\`\`

### Monthly Savings Required:
\`\`\`
if(prop("Target Date") > now(), (prop("Target Amount") - prop("Current Amount")) / dateBetween(prop("Target Date"), now(), "months"), 0)
\`\`\`

## ðŸŽ¨ Features Included:
- âœ… Complete database setup for accounts, transactions, and categories
- âœ… Dominican Peso (DOP) currency formatting throughout
- âœ… Budget tracking with visual progress indicators  
- âœ… Monthly and yearly financial reports
- âœ… Goal tracking and milestone management
- âœ… Expense categorization system
- âœ… Recurring transaction automation
- âœ… Income and expense analysis templates
- âœ… Enhanced visual hierarchy with emoji indicators
- âœ… Color coding support for quick identification
- âœ… Structured formula organization

## ðŸ’¡ Pro Tips:
- ðŸ“Œ Select the correct category for each expense to track budget accurately
- ðŸ“Œ Update your account balances regularly for accurate reporting  
- ðŸ“Œ Use the transfer function to move money between accounts
- ðŸ“Œ Set realistic monthly budgets based on your spending history
- ðŸ“Œ Set up recurring transactions for regular bills and income
- ðŸ“Œ Use color coding to quickly identify different types of transactions
- ðŸ“Œ Review your goals monthly and adjust targets as needed

## ðŸ”§ Setup Instructions:
1. Create each database using the structures above
2. Configure number properties to use DOP currency format (RD$ #,##0.00)
3. Add the formulas to calculated properties
4. Set up relations between databases
5. Create sample categories (Housing, Food, Transportation, etc.)
6. Add your bank accounts with current balances
7. Start logging transactions and set up recurring ones

## ðŸŽ¯ Enhanced Version Features:
- Structured database properties in organized tables
- Added recurring transaction formula using dateAdd
- Specified DOP currency format throughout
- Enhanced visual hierarchy with markdown
- Improved formula readability
- Added color coding support notes  
- Added emoji indicators for quick scanning

Created by Bebell Digital Solutions
Template Version 2.0 - Enhanced with DOP Support & Recurring Transactions
            `.trim();

            navigator.clipboard.writeText(templateText).then(() => {
                showToast('Enhanced Notion template copied to clipboard!', 'success');
            }).catch(() => {
                showToast('Failed to copy template text', 'error');
            });
        }
        
        
      
        
        
        
        

        // 5. EMAIL NOTIFICATIONS IMPLEMENTATION
        function initializeEmailJS() {
            // Initialize EmailJS with your public key
            // You'll need to replace 'YOUR_PUBLIC_KEY' with your actual EmailJS public key
            if (typeof emailjs !== 'undefined') {
                emailjs.init('pzi6GkEVpxFMX_PUe'); // Replace with your EmailJS public key
                emailJS = emailjs;
            }
        }

        function setupEmailNotificationToggle() {
            const emailToggle = document.getElementById('email-notifications');
            const emailSettings = document.getElementById('email-settings');
            
            if (emailToggle && emailSettings) {
                emailToggle.addEventListener('change', function() {
                    if (this.checked) {
                        emailSettings.classList.remove('hidden');
                    } else {
                        emailSettings.classList.add('hidden');
                    }
                });
            }
        }

        function setupEmailNotifications() {
            const emailAddress = document.getElementById('notification-email').value;
            const frequency = document.getElementById('notification-frequency').value;
            
            if (!emailAddress) {
                showToast('Please enter your email address', 'error');
                return;
            }
            
            if (!emailJS) {
                showEmailSetupGuide();
                return;
            }
            
            // Save email settings
            financialData.updateSettings({
                emailNotifications: true,
                notificationEmail: emailAddress,
                notificationFrequency: frequency
            });
            
            // Send test email
            sendTestEmail(emailAddress);
        }

        function sendTestEmail(email) {
            if (!emailJS) {
                showToast('EmailJS not configured', 'error');
                return;
            }

            const templateParams = {
                to_email: email,
                subject: 'Financial Dashboard - Email Notifications Activated',
                message: 'Your email notifications have been successfully set up! You will receive reminders based on your preferences.'
            };

            emailJS.send('BebellDigitalSolutions', 'bebell_notifications', templateParams)
                .then(() => {
                    showToast('Test email sent successfully!', 'success');
                })
                .catch(() => {
                    showToast('Failed to send test email. Please check your EmailJS configuration.', 'error');
                });
        }

        function sendBillReminder(bill) {
            if (!financialData.settings.emailNotifications || !financialData.settings.notificationEmail || !emailJS) {
                return;
            }

            const templateParams = {
                to_email: financialData.settings.notificationEmail,
                subject: `Bill Reminder: ${bill.name}`,
                message: `Don't forget! Your bill "${bill.name}" is due on ${formatDate(bill.dueDate)}. Amount: ${formatCurrency(bill.amount)}`
            };

            emailJS.send('BebellDigitalSolutions', 'bebell_notifications', templateParams)
                .catch(error => console.error('Failed to send bill reminder:', error));
        }

        function sendBudgetAlert(category, spent, budget) {
            if (!financialData.settings.emailNotifications || !financialData.settings.notificationEmail || !emailJS) {
                return;
            }

            const percentage = (spent / budget * 100).toFixed(1);
            const templateParams = {
                to_email: financialData.settings.notificationEmail,
                subject: `Budget Alert: ${category}`,
                message: `You've spent ${formatCurrency(spent)} (${percentage}%) of your ${formatCurrency(budget)} budget for ${category}.`
            };

            emailJS.send('BebellDigitalSolutions', 'bebell_notifications', templateParams)
                .catch(error => console.error('Failed to send budget alert:', error));
        }
        
        

        function showEmailSetupGuide() {
            const guideText = `
EMAIL NOTIFICATION SETUP GUIDE

To enable email notifications, you need to set up EmailJS:

1. CREATE EMAILJS ACCOUNT:
   - Go to https://emailjs.com
   - Sign up for a free account
   - Verify your email address

2. CREATE EMAIL SERVICE:
   - In EmailJS dashboard, go to "Email Services"
   - Add your email provider (Gmail, Outlook, etc.)
   - Follow the setup instructions

3. CREATE EMAIL TEMPLATE:
   - Go to "Email Templates"
   - Create a new template with these variables:
     - {{to_email}} - Recipient email
     - {{subject}} - Email subject
     - {{message}} - Email content

4. UPDATE DASHBOARD CODE:
   - Replace 'YOUR_PUBLIC_KEY' with your EmailJS public key
   - Replace 'YOUR_SERVICE_ID' with your service ID
   - Replace 'YOUR_TEMPLATE_ID' with your template ID

5. NOTIFICATION TYPES:
   - Budget alerts when spending exceeds 80% of budget
   - Bill reminders 3 days before due date
   - Goal milestone achievements
   - Weekly/daily financial summaries

TECHNICAL REQUIREMENTS:
- EmailJS account (free tier: 200 emails/month)
- Valid email service configuration
- Internet connection for sending emails

PRIVACY & SECURITY:
- Emails are sent directly through EmailJS
- No financial data is stored on external servers
- You control all email templates and content

After completing setup, return to settings and enter your email address to activate notifications.
            `;
            
            alert(guideText);
        }



        // Enhanced notification system
        function checkBudgetAlerts() {
            if (!financialData.settings.budgetAlerts) return;
            
            const currentDate = new Date();
            financialData.categories.filter(c => c.budget > 0).forEach(category => {
                const spent = Math.abs(financialData.transactions
                    .filter(t => {
                        const tDate = new Date(t.date);
                        return t.type === 'expense' && 
                               t.category === category.name &&
                               tDate.getMonth() === currentDate.getMonth() &&
                               tDate.getFullYear() === currentDate.getFullYear();
                    })
                    .reduce((sum, t) => sum + Math.abs(t.amount), 0));
                
                const percentage = (spent / category.budget) * 100;
                
                
                
                
                
                // Send alert if spending exceeds 80%
                if (percentage >= 80 && percentage < 100) {
                    sendBudgetAlert(category.name, spent, category.budget);
                }
            });
        }

        function checkBillReminders() {
            if (!financialData.settings.billReminders) return;
            
            const today = new Date();
            const threeDaysFromNow = new Date(today.getTime() + (3 * 24 * 60 * 60 * 1000));
            
            financialData.bills.forEach(bill => {
                const dueDate = new Date(bill.dueDate);
                if (dueDate <= threeDaysFromNow && dueDate >= today) {
                    sendBillReminder(bill);
                }
            });
        }

        // Rest of the existing functions (theme management, navigation, data loading, etc.)
        // These remain exactly the same as in the previous version...

        // Theme management
        function applyTheme() {
            if (isDarkMode) {
                document.documentElement.classList.add('dark');
                document.getElementById('theme-icon').setAttribute('data-lucide', 'moon');
            } else {
                document.documentElement.classList.remove('dark');
                document.getElementById('theme-icon').setAttribute('data-lucide', 'sun');
            }
            lucide.createIcons();
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            
            if (isDarkMode) {
                localStorage.setItem('theme', 'dark');
            } else {
                localStorage.setItem('theme', 'light');
            }
            
            applyTheme();
            
            
            
            
            // Reinitialize charts with new theme
            setTimeout(() => {
                initCharts();
            }, 100);
        }

        
        
        
        // Navigation Functions
        function showSection(sectionName) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.classList.add('hidden');
            });

            // Show selected section
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
                targetSection.classList.add('fade-in');
            }

            // Update navigation active state
            const navItems = document.querySelectorAll('.nav-item, .mobile-nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
                item.classList.remove('bg-primary-50', 'dark:bg-primary-900', 'text-primary-700', 'dark:text-primary-300');
                item.classList.add('text-gray-700', 'dark:text-gray-300');
            });
            
            
            
            

            // Add active state to current nav item
            const activeNavItems = document.querySelectorAll(`[onclick*="showSection('${sectionName}')"]`);
            activeNavItems.forEach(item => {
                item.classList.add('active');
                item.classList.add('bg-primary-50', 'dark:bg-primary-900', 'text-primary-700', 'dark:text-primary-300');
                item.classList.remove('text-gray-700', 'dark:text-gray-300');
            });

            currentSection = sectionName;




            // Load section-specific data
            loadSectionData(sectionName);
        }

        function loadSectionData(sectionName) {
            switch(sectionName) {
                case 'overview':
                    loadOverviewData();
                    break;
                case 'accounts':
                    loadAccounts();
                    break;
                case 'transactions':
                    loadTransactions();
                    break;
                case 'budgets':
                    loadBudgets();
                    break;
                case 'reports':
                    loadReports();
                    break;
                case 'calendar':
                    loadCalendar();
                    break;
            }
        }

        function loadAllData() {
            loadOverviewData();
            loadAccounts();
            loadTransactions();
            loadBudgets();
            loadReports();
            loadCalendar();
        }
        
        
        
        

        // Mobile Menu Functions
        function toggleMobileMenu() {
            const overlay = document.getElementById('mobile-overlay');
            const sidebar = document.getElementById('mobile-sidebar');
            const menuIcon = document.getElementById('mobile-menu-icon');

            if (overlay.classList.contains('hidden')) {
                overlay.classList.remove('hidden');
                sidebar.classList.remove('-translate-x-full');
                menuIcon.setAttribute('data-lucide', 'x');
            } else {
                overlay.classList.add('hidden');
                sidebar.classList.add('-translate-x-full');
                menuIcon.setAttribute('data-lucide', 'menu');
            }
            
            lucide.createIcons();
        }
        
        
        
        

        // Modal Functions
        function openAddTransactionModal() {
            showModal('add-transaction-modal');
        }

        function openAddAccountModal() {
            showModal('add-account-modal');
        }

        function openAddBudgetModal() {
            showModal('add-budget-modal');
        }

        function openAddGoalModal() {
            showModal('add-goal-modal');
        }

        function showModal(modalId) {
            document.getElementById('modal-backdrop').classList.remove('hidden');
            document.getElementById(modalId).classList.remove('hidden');
            
            
            
            
            
            // Focus first input in modal
            setTimeout(() => {
                const firstInput = document.querySelector(`#${modalId} input, #${modalId} select`);
                if (firstInput) firstInput.focus();
            }, 100);
        }

        function closeModal(modalId) {
            document.getElementById('modal-backdrop').classList.add('hidden');
            document.getElementById(modalId).classList.add('hidden');
        }

        function closeAllModals() {
            document.getElementById('modal-backdrop').classList.add('hidden');
            const modals = document.querySelectorAll('[id$="-modal"]');
            modals.forEach(modal => {
                modal.classList.add('hidden');
            });
        }
        
        
        
        

        // Toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            
            toastMessage.textContent = message;
            
            
            
            // Set toast color based on type
            toast.className = 'toast show px-6 py-3 rounded-lg shadow-lg';
            if (type === 'success') {
                toast.classList.add('bg-green-500', 'text-white');
            } else if (type === 'error') {
                toast.classList.add('bg-red-500', 'text-white');
            } else if (type === 'info') {
                toast.classList.add('bg-blue-500', 'text-white');
            }
            
            
            
            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                toast.classList.add('hide');
            }, 3000);
        }



        // Data Loading Functions (keeping existing ones)
        function loadOverviewData() {
            const totalBalance = financialData.accounts.reduce((sum, account) => sum + account.balance, 0);
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            
            const monthlyIncome = financialData.transactions
                .filter(t => {
                    const tDate = new Date(t.date);
                    return t.type === 'income' && 
                           tDate.getMonth() === currentMonth && 
                           tDate.getFullYear() === currentYear;
                })
                .reduce((sum, t) => sum + Math.abs(t.amount), 0);
                
            const monthlyExpenses = financialData.transactions
                .filter(t => {
                    const tDate = new Date(t.date);
                    return t.type === 'expense' && 
                           tDate.getMonth() === currentMonth && 
                           tDate.getFullYear() === currentYear;
                })
                .reduce((sum, t) => sum + Math.abs(t.amount), 0);
                
            const savingsRate = monthlyIncome > 0 ? ((monthlyIncome - monthlyExpenses) / monthlyIncome * 100).toFixed(1) : 0;

            
            
            // Update UI
            document.getElementById('total-balance').textContent = formatCurrency(totalBalance);
            document.getElementById('monthly-income').textContent = formatCurrency(monthlyIncome);
            document.getElementById('monthly-expenses').textContent = formatCurrency(monthlyExpenses);
            document.getElementById('savings-rate').textContent = savingsRate + '%';

            // Load recent transactions and goals
            loadRecentTransactions();
            loadFinancialGoals();
            
            // Check for alerts
            checkBudgetAlerts();
            checkBillReminders();
        }

        function loadRecentTransactions() {
            const container = document.getElementById('recent-transactions');
            const recentTransactions = financialData.transactions
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5);
            
            if (recentTransactions.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                        <i data-lucide="credit-card" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                        <p>No transactions yet. Add your first transaction to get started!</p>
                    </div>
                `;
            } else {
                container.innerHTML = recentTransactions.map(transaction => {
                    const account = financialData.accounts.find(a => a.id === transaction.account);
                    const isExpense = transaction.type === 'expense';
                    const amountClass = isExpense ? 'text-danger-600 dark:text-danger-400' : 'text-success-600 dark:text-success-400';
                    
                    return `
                        <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-gray-100 dark:bg-gray-600 rounded-lg flex items-center justify-center mr-3">
                                    <i data-lucide="${getTransactionIcon(transaction.type)}" class="w-5 h-5 text-gray-600 dark:text-gray-400"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-900 dark:text-white">${transaction.description}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">${account?.name || 'Unknown Account'} â€¢ ${formatDate(transaction.date)}</p>
                                </div>
                            </div>
                            <p class="font-semibold ${amountClass}">${formatCurrency(Math.abs(transaction.amount))}</p>
                        </div>
                    `;
                }).join('');
            }

            lucide.createIcons();
        }

        function loadFinancialGoals() {
            const container = document.getElementById('financial-goals');
            
            if (financialData.goals.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500 dark:text-gray-400 col-span-full">
                        <i data-lucide="target" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                        <p>No goals set yet. Add your first financial goal!</p>
                    </div>
                `;
            } else {
                container.innerHTML = financialData.goals.map(goal => {
                    const progress = goal.target > 0 ? (goal.current / goal.target * 100).toFixed(1) : 0;
                    
                    return `
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-medium text-gray-900 dark:text-white">${goal.name}</h4>
                                <span class="text-sm text-gray-500 dark:text-gray-400">${progress}%</span>
                            </div>
                            <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2 mb-2">
                                <div class="bg-primary-600 h-2 rounded-full progress-bar" style="width: ${progress}%"></div>
                            </div>
                            <div class="flex justify-between text-sm text-gray-500 dark:text-gray-400">
                                <span>${formatCurrency(goal.current)}</span>
                                <span>${formatCurrency(goal.target)}</span>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        function loadAccounts() {
            const container = document.getElementById('accounts-grid');
            if (!container) return;
            
            if (financialData.accounts.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12 text-gray-500 dark:text-gray-400 col-span-full">
                        <i data-lucide="building-2" class="w-16 h-16 mx-auto mb-4 opacity-50"></i>
                        <p class="text-xl mb-2">No accounts yet</p>
                        <p>Add your first account to start tracking your finances!</p>
                        <button onclick="openAddAccountModal()" class="mt-4 bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                            Add Account
                        </button>
                    </div>
                `;
            } else {
                container.innerHTML = financialData.accounts.map(account => {
                    const isCredit = account.type === 'credit';
                    const balanceClass = account.balance < 0 ? 'text-danger-600 dark:text-danger-400' : 'text-success-600 dark:text-success-400';
                    
                    return `
                        <div class="card-hover bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between mb-4">
                                <div class="w-12 h-12 bg-primary-100 dark:bg-primary-900 rounded-lg flex items-center justify-center">
                                    <i data-lucide="${getAccountIcon(account.type)}" class="w-6 h-6 text-primary-600 dark:text-primary-400"></i>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm text-gray-500 dark:text-gray-400">${account.bank}</p>
                                    <p class="text-xs text-gray-400 dark:text-gray-500 uppercase">${account.type}</p>
                                </div>
                            </div>
                            <h3 class="font-semibold text-gray-900 dark:text-white mb-2">${account.name}</h3>
                            <p class="text-2xl font-bold ${balanceClass} mb-2">${formatCurrency(Math.abs(account.balance))}</p>
                            ${isCredit && account.limit ? `
                                <div class="mt-4">
                                    <div class="flex justify-between text-sm text-gray-500 dark:text-gray-400 mb-1">
                                        <span>Credit Used</span>
                                        <span>${(Math.abs(account.balance) / account.limit * 100).toFixed(1)}%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2">
                                        <div class="bg-primary-600 h-2 rounded-full" style="width: ${Math.abs(account.balance) / account.limit * 100}%"></div>
                                    </div>
                                </div>
                            ` : ''}
                            <div class="mt-4 flex space-x-2">
                                <button onclick="editAccount(${account.id})" class="flex-1 text-sm px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700">
                                    Edit
                                </button>
                                <button onclick="deleteAccount(${account.id})" class="flex-1 text-sm px-3 py-2 text-danger-600 border border-danger-300 rounded-lg hover:bg-danger-50">
                                    Delete
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            lucide.createIcons();
        }
        
        
        
        

       function loadTransactions() {
    const tbody = document.getElementById('transactions-table-body');
    if (!tbody) return;
    
    if (financialData.transactions.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="7" class="px-6 py-12 text-center">
                    <div class="text-gray-500 dark:text-gray-400">
                        <i data-lucide="credit-card" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                        <p class="text-lg mb-2">No transactions yet</p>
                        <p>Start by adding your first transaction!</p>
                    </div>
                </td>
            </tr>
        `;
    } else {
        const filteredTransactions = getFilteredTransactions();
        tbody.innerHTML = filteredTransactions.map(transaction => {
            const account = financialData.accounts.find(a => a.id === transaction.account);
            const isExpense = transaction.type === 'expense';
            const amountClass = isExpense ? 'text-danger-600 dark:text-danger-400' : 'text-success-600 dark:text-success-400';
            const recurringIcon = transaction.recurring ? 
                `<i data-lucide="repeat" class="w-4 h-4 text-blue-500 dark:text-blue-400 ml-1" title="Recurring transaction"></i>` : '';
            
            return `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">${formatDate(transaction.date)}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-gray-100 dark:bg-gray-600 rounded-lg flex items-center justify-center mr-3">
                                <i data-lucide="${getTransactionIcon(transaction.type)}" class="w-4 h-4 text-gray-600 dark:text-gray-400"></i>
                            </div>
                            <span class="text-sm font-medium text-gray-900 dark:text-white">
                                ${transaction.description}
                                ${recurringIcon}
                            </span>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200">
                            ${transaction.category || 'Uncategorized'}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${account?.name || 'Unknown'}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold ${amountClass}">${formatCurrency(Math.abs(transaction.amount))}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 space-x-2">
                        <button onclick="editTransaction(${transaction.id})" class="text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-300">Edit</button>
                        <button onclick="deleteTransaction(${transaction.id})" class="text-danger-600 dark:text-danger-400 hover:text-danger-900 dark:hover:text-danger-300">Delete</button>
                    </td>
                </tr>
            `;
        }).join('');
    }

    lucide.createIcons();
}





        function loadBudgets() {
            const container = document.getElementById('budgets-grid');
            if (!container) return;
            
            if (financialData.categories.filter(c => c.budget > 0).length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12 text-gray-500 dark:text-gray-400 col-span-full">
                        <i data-lucide="pie-chart" class="w-16 h-16 mx-auto mb-4 opacity-50"></i>
                        <p class="text-xl mb-2">No budgets set</p>
                        <p>Create your first budget to start tracking your spending!</p>
                        <button onclick="openAddBudgetModal()" class="mt-4 bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                            Add Budget
                        </button>
                    </div>
                `;
            } else {
                const currentDate = new Date();
                container.innerHTML = financialData.categories.filter(c => c.budget > 0).map(category => {
                    const spent = Math.abs(financialData.transactions
                        .filter(t => {
                            const tDate = new Date(t.date);
                            return t.type === 'expense' && 
                                   t.category === category.name &&
                                   tDate.getMonth() === currentDate.getMonth() &&
                                   tDate.getFullYear() === currentDate.getFullYear();
                        })
                        .reduce((sum, t) => sum + Math.abs(t.amount), 0));
                    const remaining = Math.max(0, category.budget - spent);
                    const progress = category.budget > 0 ? (spent / category.budget * 100).toFixed(1) : 0;
                    const isOverBudget = spent > category.budget;
                    
                    return `
                        <div class="card-hover bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center">
                                    <div class="w-3 h-3 rounded-full mr-3" style="background-color: ${category.color}"></div>
                                    <h3 class="font-semibold text-gray-900 dark:text-white">${category.name}</h3>
                                </div>
                                <span class="text-sm text-gray-500 dark:text-gray-400">${progress}%</span>
                            </div>
                            
                            <div class="mb-4">
                                <div class="flex justify-between text-sm text-gray-600 dark:text-gray-400 mb-1">
                                    <span>Spent: ${formatCurrency(spent)}</span>
                                    <span>Budget: ${formatCurrency(category.budget)}</span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2">
                                    <div class="h-2 rounded-full progress-bar ${isOverBudget ? 'bg-danger-500' : 'bg-primary-600'}" 
                                         style="width: ${Math.min(100, progress)}%"></div>
                                </div>
                            </div>
                            
                            <div class="text-center">
                                <p class="text-sm text-gray-500 dark:text-gray-400">
                                    ${isOverBudget ? 'Over budget by' : 'Remaining'}: 
                                    <span class="font-semibold ${isOverBudget ? 'text-danger-600 dark:text-danger-400' : 'text-success-600 dark:text-success-400'}">
                                        ${formatCurrency(Math.abs(remaining))}
                                    </span>
                                </p>
                            </div>
                            
                            <div class="mt-4 flex space-x-2">
                                <button onclick="editBudget(${category.id})" class="flex-1 text-sm px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700">
                                    Edit
                                </button>
                                <button onclick="deleteBudget(${category.id})" class="flex-1 text-sm px-3 py-2 text-danger-600 border border-danger-300 rounded-lg hover:bg-danger-50">
                                    Delete
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }
        
        
        

        function loadReports() {
            // Reports data will be loaded when charts are initialized
        }

        function loadUpcomingEvents() {
            // Load upcoming bills
            const upcomingBills = document.getElementById('upcoming-bills');
            if (upcomingBills) {
                upcomingBills.innerHTML = `
                    <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                        <i data-lucide="calendar-check" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                        <p>No upcoming bills</p>
                    </div>
                `;
            }




            // Load goal milestones
            const goalMilestones = document.getElementById('goal-milestones');
            if (goalMilestones) {
                if (financialData.goals.length > 0) {
                    goalMilestones.innerHTML = financialData.goals.slice(0, 3).map(goal => {
                        const progress = goal.target > 0 ? (goal.current / goal.target * 100).toFixed(1) : 0;
                        return `
                            <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-primary-100 dark:bg-primary-900 rounded-lg flex items-center justify-center mr-3">
                                        <i data-lucide="target" class="w-4 h-4 text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-900 dark:text-white">${goal.name}</p>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Target: ${formatDate(goal.deadline)}</p>
                                    </div>
                                </div>
                                <span class="text-sm font-semibold text-primary-600 dark:text-primary-400">${progress}%</span>
                            </div>
                        `;
                    }).join('');
                } else {
                    goalMilestones.innerHTML = `
                        <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                            <i data-lucide="target" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                            <p>No goal milestones</p>
                        </div>
                    `;
                }
            }

            lucide.createIcons();
        }





        // Calendar Navigation
        function previousMonth() {
            if (currentMonth === 0) {
                currentMonth = 11;
                currentYear--;
            } else {
                currentMonth--;
            }
            loadCalendar();
        }

        function nextMonth() {
            if (currentMonth === 11) {
                currentMonth = 0;
                currentYear++;
            } else {
                currentMonth++;
            }
            loadCalendar();
        }
        
        
        
        

        // Settings Functions
        function showSettingsTab(tabName) {
            // Hide all settings content
            const settingsContents = document.querySelectorAll('.settings-content');
            settingsContents.forEach(content => {
                content.classList.add('hidden');
            });





            // Show selected settings content
            const targetContent = document.getElementById(tabName + '-settings');
            if (targetContent) {
                targetContent.classList.remove('hidden');
            }





            // Update tab active state
            const settingsTabs = document.querySelectorAll('.settings-tab');
            settingsTabs.forEach(tab => {
                tab.classList.remove('active', 'border-primary-500', 'text-primary-600', 'dark:text-primary-400');
                tab.classList.add('border-transparent', 'text-gray-500', 'dark:text-gray-400');
            });
            
            
            
            
            
            
            
            

            // Add active state to current tab
            const activeTab = document.querySelector(`[onclick="showSettingsTab('${tabName}')"]`);
            if (activeTab) {
                activeTab.classList.add('active', 'border-primary-500', 'text-primary-600', 'dark:text-primary-400');
                activeTab.classList.remove('border-transparent', 'text-gray-500', 'dark:text-gray-400');
            }
        }




        function loadSettings() {
            document.getElementById('theme-select').value = financialData.settings.theme;
            document.getElementById('currency-select').value = financialData.settings.currency;
            document.getElementById('date-format-select').value = financialData.settings.dateFormat;
            document.getElementById('budget-alerts').checked = financialData.settings.budgetAlerts;
            document.getElementById('bill-reminders').checked = financialData.settings.billReminders;
            document.getElementById('goal-progress').checked = financialData.settings.goalProgress;
            document.getElementById('email-notifications').checked = financialData.settings.emailNotifications;
            document.getElementById('notification-email').value = financialData.settings.notificationEmail;
            document.getElementById('notification-frequency').value = financialData.settings.notificationFrequency;
            document.getElementById('two-factor').checked = financialData.settings.twoFactor;
            
            
            
            
            
            
            
            
            
            // Show email settings if enabled
            if (financialData.settings.emailNotifications) {
                document.getElementById('email-settings').classList.remove('hidden');
            }
        }

        function handleThemeChange() {
            const themeSelect = document.getElementById('theme-select');
            const selectedTheme = themeSelect.value;
            
            financialData.updateSettings({ theme: selectedTheme });
            
            if (selectedTheme === 'system') {
                isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
                localStorage.removeItem('theme');
            } else {
                isDarkMode = selectedTheme === 'dark';
                localStorage.setItem('theme', selectedTheme);
            }
            
            applyTheme();
            setTimeout(() => initCharts(), 100);
        }




        function handleCurrencyChange() {
            const currency = document.getElementById('currency-select').value;
            financialData.updateSettings({ currency });
            loadAllData(); // Refresh all displays
        }

        function handleDateFormatChange() {
            const dateFormat = document.getElementById('date-format-select').value;
            financialData.updateSettings({ dateFormat });
            loadAllData(); // Refresh all displays
        }
        
        
        
        

        // CRUD Operations
        function editAccount(id) {
            const account = financialData.accounts.find(a => a.id === id);
            if (account) {
                // Populate form with account data
                document.getElementById('account-name').value = account.name;
                document.getElementById('account-type').value = account.type;
                document.getElementById('account-bank').value = account.bank;
                document.getElementById('account-balance').value = account.balance;
                if (account.limit) {
                    document.getElementById('account-limit').value = account.limit;
                }
                
                
                
                
                
                // Store ID for update
                document.getElementById('account-form').dataset.editId = id;
                
                showModal('add-account-modal');
            }
        }

        function deleteAccount(id) {
            if (confirm('Are you sure you want to delete this account? This will also remove all associated transactions.')) {
                // Remove associated transactions
                financialData.transactions = financialData.transactions.filter(t => t.account !== id);
                financialData.saveToStorage('transactions', financialData.transactions);
                
                // Remove account
                financialData.deleteAccount(id);
                
                loadAllData();
                showToast('Account deleted successfully');
            }
        }

        function editTransaction(id) {
            const transaction = financialData.transactions.find(t => t.id === id);
            if (transaction) {
                // Populate form
                document.getElementById('transaction-type').value = transaction.type;
                document.getElementById('transaction-amount').value = Math.abs(transaction.amount);
                document.getElementById('transaction-description').value = transaction.description;
                document.getElementById('transaction-category').value = transaction.category;
                document.getElementById('transaction-account').value = transaction.account;
                document.getElementById('transaction-date').value = transaction.date;
                
                
                
                
                
                
                
                
                // Store ID for update
                document.getElementById('transaction-form').dataset.editId = id;
                
                showModal('add-transaction-modal');
            }
        }

        function deleteTransaction(id) {
            if (confirm('Are you sure you want to delete this transaction?')) {
                financialData.deleteTransaction(id);
                loadAllData();
                showToast('Transaction deleted successfully');
            }
        }

        function editBudget(id) {
            const category = financialData.categories.find(c => c.id === id);
            if (category) {
                document.getElementById('budget-category').value = category.name;
                document.getElementById('budget-amount').value = category.budget;
                document.getElementById('budget-color').value = category.color;
                
                
                
                
                
                // Store ID for update
                document.getElementById('budget-form').dataset.editId = id;
                
                showModal('add-budget-modal');
            }
        }

        function deleteBudget(id) {
            if (confirm('Are you sure you want to delete this budget?')) {
                const index = financialData.categories.findIndex(c => c.id === id);
                if (index !== -1) {
                    financialData.categories[index].budget = 0;
                    financialData.saveToStorage('categories', financialData.categories);
                }
                loadBudgets();
                showToast('Budget deleted successfully');
            }
        }
        
        
        
        

        // Filtering
        function getFilteredTransactions() {
            const searchTerm = document.getElementById('transaction-search').value.toLowerCase();
            const typeFilter = document.getElementById('transaction-type-filter').value;
            const categoryFilter = document.getElementById('transaction-category-filter').value;
            const accountFilter = parseInt(document.getElementById('transaction-account-filter').value);

            return financialData.transactions
                .filter(transaction => {
                    const matchesSearch = !searchTerm || 
                        transaction.description.toLowerCase().includes(searchTerm) ||
                        transaction.category?.toLowerCase().includes(searchTerm);
                    const matchesType = !typeFilter || transaction.type === typeFilter;
                    const matchesCategory = !categoryFilter || transaction.category === categoryFilter;
                    const matchesAccount = !accountFilter || transaction.account === accountFilter;
                    
                    return matchesSearch && matchesType && matchesCategory && matchesAccount;
                })
                .sort((a, b) => new Date(b.date) - new Date(a.date));
        }

        function filterTransactions() {
            loadTransactions();
        }
        
        
        

        // Chart Functions
        function initCharts() {
            initSpendingChart();
            initBudgetChart();
            initIncomeExpenseChart();
            initCategoryDistributionChart();
        }

        function initSpendingChart() {
            const ctx = document.getElementById('spending-chart');
            if (!ctx) return;

            const chart = Chart.getChart(ctx);
            if (chart) {
                chart.destroy();
            }

            const isDark = document.documentElement.classList.contains('dark');
            const textColor = isDark ? '#f9fafb' : '#1f2937';
            const gridColor = isDark ? '#374151' : '#e5e7eb';






            // Calculate last 6 months spending
            const monthlySpending = [];
            const monthLabels = [];
            const currentDate = new Date();
            
            for (let i = 5; i >= 0; i--) {
                const month = new Date(currentDate.getFullYear(), currentDate.getMonth() - i, 1);
                monthLabels.push(month.toLocaleDateString('en-US', { month: 'short' }));
                
                const spending = financialData.transactions
                    .filter(t => {
                        const tDate = new Date(t.date);
                        return t.type === 'expense' && 
                               tDate.getMonth() === month.getMonth() && 
                               tDate.getFullYear() === month.getFullYear();
                    })
                    .reduce((sum, t) => sum + Math.abs(t.amount), 0);
                    
                monthlySpending.push(spending);
            }

            charts.spending = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: monthLabels,
                    datasets: [{
                        label: 'Expenses',
                        data: monthlySpending,
                        borderColor: '#DF1783',
                        backgroundColor: 'rgba(223, 23, 131, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: textColor
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: gridColor
                            },
                            ticks: {
                                color: textColor
                            }
                        },
                        y: {
                            grid: {
                                color: gridColor
                            },
                            ticks: {
                                color: textColor,
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    }
                }
            });
        }

        function initBudgetChart() {
            const ctx = document.getElementById('budget-chart');
            if (!ctx) return;

            const chart = Chart.getChart(ctx);
            if (chart) {
                chart.destroy();
            }

            const isDark = document.documentElement.classList.contains('dark');
            const textColor = isDark ? '#f9fafb' : '#1f2937';

            const categoriesWithBudgets = financialData.categories.filter(c => c.budget > 0);
            
            if (categoriesWithBudgets.length === 0) {
                // Show no data message
                ctx.getContext('2d').clearRect(0, 0, ctx.width, ctx.height);
                return;
            }

            charts.budget = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: categoriesWithBudgets.map(c => c.name),
                    datasets: [{
                        data: categoriesWithBudgets.map(c => c.budget),
                        backgroundColor: categoriesWithBudgets.map(c => c.color),
                        borderWidth: 2,
                        borderColor: isDark ? '#1f2937' : '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: textColor,
                                padding: 20
                            }
                        }
                    }
                }
            });
        }

        function initIncomeExpenseChart() {
            const ctx = document.getElementById('income-expense-chart');
            if (!ctx) return;

            const chart = Chart.getChart(ctx);
            if (chart) {
                chart.destroy();
            }

            const isDark = document.documentElement.classList.contains('dark');
            const textColor = isDark ? '#f9fafb' : '#1f2937';
            const gridColor = isDark ? '#374151' : '#e5e7eb';

           
           
           
           
           
           // Calculate last 6 months income and expenses
            const monthlyIncome = [];
            const monthlyExpenses = [];
            const monthLabels = [];
            const currentDate = new Date();
            
            for (let i = 5; i >= 0; i--) {
                const month = new Date(currentDate.getFullYear(), currentDate.getMonth() - i, 1);
                monthLabels.push(month.toLocaleDateString('en-US', { month: 'short' }));
                
                const income = financialData.transactions
                    .filter(t => {
                        const tDate = new Date(t.date);
                        return t.type === 'income' && 
                               tDate.getMonth() === month.getMonth() && 
                               tDate.getFullYear() === month.getFullYear();
                    })
                    .reduce((sum, t) => sum + Math.abs(t.amount), 0);
                    
                const expenses = financialData.transactions
                    .filter(t => {
                        const tDate = new Date(t.date);
                        return t.type === 'expense' && 
                               tDate.getMonth() === month.getMonth() && 
                               tDate.getFullYear() === month.getFullYear();
                    })
                    .reduce((sum, t) => sum + Math.abs(t.amount), 0);
                    
                monthlyIncome.push(income);
                monthlyExpenses.push(expenses);
            }

            charts.incomeExpense = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: monthLabels,
                    datasets: [
                        {
                            label: 'Income',
                            data: monthlyIncome,
                            backgroundColor: '#10b981'
                        },
                        {
                            label: 'Expenses',
                            data: monthlyExpenses,
                            backgroundColor: '#DF1783'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: textColor
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: gridColor
                            },
                            ticks: {
                                color: textColor
                            }
                        },
                        y: {
                            grid: {
                                color: gridColor
                            },
                            ticks: {
                                color: textColor,
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    }
                }
            });
        }

        function initCategoryDistributionChart() {
            const ctx = document.getElementById('category-distribution-chart');
            if (!ctx) return;

            const chart = Chart.getChart(ctx);
            if (chart) {
                chart.destroy();
            }

            const isDark = document.documentElement.classList.contains('dark');
            const textColor = isDark ? '#f9fafb' : '#1f2937';








            // Calculate spending by category for current month
            const currentDate = new Date();
            const categorySpending = [];
            const categoryNames = [];
            const categoryColors = [];
            
            financialData.categories.forEach(category => {
                const spent = Math.abs(financialData.transactions
                    .filter(t => {
                        const tDate = new Date(t.date);
                        return t.type === 'expense' && 
                               t.category === category.name &&
                               tDate.getMonth() === currentDate.getMonth() &&
                               tDate.getFullYear() === currentDate.getFullYear();
                    })
                    .reduce((sum, t) => sum + Math.abs(t.amount), 0));
                    
                if (spent > 0) {
                    categorySpending.push(spent);
                    categoryNames.push(category.name);
                    categoryColors.push(category.color);
                }
            });

            if (categorySpending.length === 0) {
                // Show no data message
                ctx.getContext('2d').clearRect(0, 0, ctx.width, ctx.height);
                return;
            }

            charts.categoryDistribution = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: categoryNames,
                    datasets: [{
                        data: categorySpending,
                        backgroundColor: categoryColors,
                        borderWidth: 2,
                        borderColor: isDark ? '#1f2937' : '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: textColor,
                                padding: 20
                            }
                        }
                    }
                }
            });
        }

        function generateReport() {
            // Regenerate charts with current data
            initIncomeExpenseChart();
            initCategoryDistributionChart();
            showToast('Report generated successfully!');
        }
        
        
        
        
        

        // Data Import/Export
        function exportData(format) {
            if (format === 'csv') {
                exportToCSV();
            } else if (format === 'pdf') {
                showToast('PDF export feature coming soon!', 'info');
            }
        }

        function exportToCSV() {
            const csvContent = [
                ['Date', 'Type', 'Description', 'Category', 'Account', 'Amount'],
                ...financialData.transactions.map(t => {
                    const account = financialData.accounts.find(a => a.id === t.account);
                    return [t.date, t.type, t.description, t.category || '', account?.name || '', t.amount];
                })
            ].map(row => row.join(',')).join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'financial_data.csv';
            a.click();
            window.URL.revokeObjectURL(url);
            
            showToast('Data exported to CSV successfully!');
        }

        function importData() {
            const file = document.getElementById('import-file').files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csv = e.target.result;
                    const lines = csv.split('\n');
                    const headers = lines[0].split(',');
                    
                    
                    
                    
                    // Basic CSV parsing (simplified)
                    for (let i = 1; i < lines.length; i++) {
                        const data = lines[i].split(',');
                        if (data.length >= 6) {
                            const transaction = {
                                date: data[0],
                                type: data[1],
                                description: data[2],
                                category: data[3],
                                account: 1, // Default to first account
                                amount: parseFloat(data[5])
                            };
                            financialData.addTransaction(transaction);
                        }
                    }
                    
                    loadAllData();
                    showToast('Data imported successfully!');
                } catch (error) {
                    showToast('Error importing data. Please check file format.', 'error');
                }
            };
            reader.readAsText(file);
        }

        function resetAllData() {
            if (confirm('Are you sure you want to reset all data? This action cannot be undone.')) {
                financialData.clearAllData();
                financialData = new FinancialData(); // Reinitialize
                loadAllData();
                populateDropdowns();
                initCharts();
                showToast('All data has been reset');
            }
        }







         // Form Handlers
function setupFormHandlers() {



    // Transaction form
    document.getElementById('transaction-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = {
            type: document.getElementById('transaction-type').value,
            amount: parseFloat(document.getElementById('transaction-amount').value),
            description: document.getElementById('transaction-description').value,
            category: document.getElementById('transaction-category').value,
            account: parseInt(document.getElementById('transaction-account').value),
            date: document.getElementById('transaction-date').value
        };
        
        // Validate required fields
        if (!formData.amount || !formData.description || !formData.account || !formData.date) {
            showToast('Please fill in all required fields', 'error');
            return;
        }
        
        const editId = this.dataset.editId;
        const isRecurring = document.getElementById('transaction-recurring').checked;
        const signedAmount = formData.type === 'expense' ? -Math.abs(formData.amount) : Math.abs(formData.amount);
        
        if (editId) {
                
                
                
                
                
                
                
                
           formData.amount = signedAmount;
            financialData.updateTransaction(parseInt(editId), formData);
            showToast('Transaction updated successfully!');
            delete this.dataset.editId;
        } else if (isRecurring) {
            // Handle recurring transactions
            const frequency = document.getElementById('transaction-frequency').value;
            let times = parseInt(document.getElementById('transaction-times').value) || 12;
            
            
            
            
            
             // Validate times input
            if (times < 1) times = 1;
            if (times > 100) times = 100;
            
            let baseDate = new Date(formData.date);
            let createdCount = 0;
            
            for (let i = 0; i < times; i++) {
                const transaction = { 
                    ...formData,
                    date: baseDate.toISOString().split('T')[0],
                    amount: signedAmount,
                    recurring: true,
                    frequency: i > 0 ? frequency : undefined // Only set frequency for future instances
                };
                
                financialData.addTransaction(transaction);
                createdCount++;
                    
                    
                    
                    
           // Increment date based on frequency
                switch(frequency) {
                    case 'daily': baseDate.setDate(baseDate.getDate() + 1); break;
                    case 'weekly': baseDate.setDate(baseDate.getDate() + 7); break;
                    case 'biweekly': baseDate.setDate(baseDate.getDate() + 14); break;
                    case 'monthly': baseDate.setMonth(baseDate.getMonth() + 1); break;
                    case 'quarterly': baseDate.setMonth(baseDate.getMonth() + 3); break;
                    case 'yearly': baseDate.setFullYear(baseDate.getFullYear() + 1); break;
                }
            }
            
            showToast(`Successfully created ${createdCount} recurring transactions!`, 'success');
        } else {
            // Add single transaction
            formData.amount = signedAmount;
            financialData.addTransaction(formData);
            showToast('Transaction added successfully!');
        }
        
        loadAllData();
        initCharts();
        closeModal('add-transaction-modal');
        this.reset();
        document.getElementById('transaction-date').value = new Date().toISOString().split('T')[0];
    });
    
    
    
    
    
    // Add recurring toggle handler with validation
    document.getElementById('transaction-recurring').addEventListener('change', function() {
        const recurringOptions = document.getElementById('recurring-options');
        recurringOptions.classList.toggle('hidden', !this.checked);
        
        if (this.checked) {
            // Initialize default values
            document.getElementById('transaction-frequency').value = 'monthly';
            document.getElementById('transaction-times').value = '12';
        }
    });

                


    // Validate times input
    document.getElementById('transaction-times').addEventListener('input', function() {
        if (this.value < 1) this.value = 1;
        if (this.value > 100) this.value = 100;
    });









            
            
            

            // Account form
            document.getElementById('account-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = {
                    name: document.getElementById('account-name').value,
                    type: document.getElementById('account-type').value,
                    bank: document.getElementById('account-bank').value,
                    balance: parseFloat(document.getElementById('account-balance').value) || 0
                };
                
                if (formData.type === 'credit') {
                    formData.limit = parseFloat(document.getElementById('account-limit').value) || 0;
                }
                
                // Validate required fields
                if (!formData.name || !formData.type || !formData.bank) {
                    showToast('Please fill in all required fields', 'error');
                    return;
                }
                
                const editId = this.dataset.editId;
                
                if (editId) {
                    // Update existing account
                    financialData.updateAccount(parseInt(editId), formData);
                    showToast('Account updated successfully!');
                    delete this.dataset.editId;
                } else {
                    // Add new account
                    financialData.addAccount(formData);
                    showToast('Account added successfully!');
                }
                
                loadAllData();
                populateDropdowns();
                closeModal('add-account-modal');
                this.reset();
            });






            // Budget form
            document.getElementById('budget-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const categoryName = document.getElementById('budget-category').value;
                const budgetAmount = parseFloat(document.getElementById('budget-amount').value);
                const budgetColor = document.getElementById('budget-color').value;
                
                if (!categoryName || !budgetAmount) {
                    showToast('Please fill in all required fields', 'error');
                    return;
                }
                
                const editId = this.dataset.editId;
                
                if (editId) {
                    // Update existing category
                    const index = financialData.categories.findIndex(c => c.id === parseInt(editId));
                    if (index !== -1) {
                        financialData.categories[index] = {
                            ...financialData.categories[index],
                            name: categoryName,
                            budget: budgetAmount,
                            color: budgetColor
                        };
                        financialData.saveToStorage('categories', financialData.categories);
                    }
                    showToast('Budget updated successfully!');
                    delete this.dataset.editId;
                } else {
                    // Add new category
                    const newCategory = {
                        name: categoryName,
                        budget: budgetAmount,
                        color: budgetColor
                    };
                    financialData.addCategory(newCategory);
                    showToast('Budget added successfully!');
                }
                
                loadBudgets();
                populateDropdowns();
                initCharts();
                closeModal('add-budget-modal');
                this.reset();
            });





            // Goal form
            document.getElementById('goal-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = {
                    name: document.getElementById('goal-name').value,
                    target: parseFloat(document.getElementById('goal-target').value),
                    current: parseFloat(document.getElementById('goal-current').value) || 0,
                    deadline: document.getElementById('goal-deadline').value
                };
                
                if (!formData.name || !formData.target) {
                    showToast('Please fill in all required fields', 'error');
                    return;
                }
                
                financialData.addGoal(formData);
                showToast('Goal added successfully!');
                
                loadOverviewData();
                loadCalendar();
                closeModal('add-goal-modal');
                this.reset();
            });






            // Account type change handler
            document.getElementById('account-type').addEventListener('change', function() {
                const creditLimitField = document.getElementById('credit-limit-field');
                if (this.value === 'credit') {
                    creditLimitField.classList.remove('hidden');
                    document.getElementById('account-limit').required = true;
                } else {
                    creditLimitField.classList.add('hidden');
                    document.getElementById('account-limit').required = false;
                }
            });
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            const format = financialData.settings.dateFormat || 'MM/DD/YYYY';
            
            if (format === 'DD/MM/YYYY') {
                return date.toLocaleDateString('en-GB');
            } else if (format === 'YYYY-MM-DD') {
                return date.toISOString().split('T')[0];
            } else {
                return date.toLocaleDateString('en-US');
            }
        }

        function getAccountIcon(type) {
            const icons = {
                'checking': 'building-2',
                'savings': 'piggy-bank',
                'business': 'briefcase',
                'credit': 'credit-card',
                'investment': 'trending-up'
            };
            return icons[type] || 'wallet';
        }

        function getTransactionIcon(type) {
            const icons = {
                'income': 'arrow-down-left',
                'expense': 'arrow-up-right',
                'transfer': 'arrow-right-left'
            };
            return icons[type] || 'circle';
        }

        function populateDropdowns() {
            // Populate category dropdowns
            const categorySelects = document.querySelectorAll('#transaction-category, #transaction-category-filter');
            categorySelects.forEach(select => {
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = '<option value="">Select Category</option>' +
                        financialData.categories.map(category => 
                            `<option value="${category.name}">${category.name}</option>`
                        ).join('');
                    select.value = currentValue; // Restore selection
                }
            });
            
            
            

            // Populate account dropdowns
            const accountSelects = document.querySelectorAll('#transaction-account, #transaction-account-filter');
            accountSelects.forEach(select => {
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = '<option value="">Select Account</option>' +
                        financialData.accounts.map(account => 
                            `<option value="${account.id}">${account.name}</option>`
                        ).join('');
                    select.value = currentValue; // Restore selection
                }
            });
        }
        
        

        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', init);
        
        
        

        // Handle system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
            if (financialData.settings.theme === 'system') {
                isDarkMode = e.matches;
                applyTheme();
                setTimeout(() => initCharts(), 100);
            }
        });

        // Handle window resize for charts
        window.addEventListener('resize', function() {
            Object.values(charts).forEach(chart => {
                if (chart) chart.resize();
            });
        });

        // Schedule daily notifications check
        setInterval(() => {
            if (financialData.settings.emailNotifications) {
                checkBudgetAlerts();
                checkBillReminders();
            }
        }, 24 * 60 * 60 * 1000); // Check once per day
    </script>

</body>
</html>
